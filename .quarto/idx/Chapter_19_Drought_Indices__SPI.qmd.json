{"title":"Drought Indices -- SPI","markdown":{"headingText":"Drought Indices -- SPI","containsRefs":false,"markdown":"## Introduction\n\nThe Standardised Precipitation Index (SPI) is acknowledged as an obvious\nindex to monitor drought, e.g. (Keyantash & (Eds), 2018). It is\ndescribed in the WMO guide (Svoboda, Hayes, & Wood, 2012).\n\nThere are various R packages to implement SPI and R-Instat includes the\ncommand from the SPEI package (Beguería & Vicente-Serrano, 2017). This\npermits the calculation of the SPI index, as described by WMO and an\nSPEI index that includes evapotranspiration, (Vicente-Serrano, Beguería,\n& López-Moreno, 2010).\n\nThe SPI index is promoted as being superior to the Palmer Drought\nSeverity Index. This is based on an original index by (Palmer, 1965),\ngeneralised by (Wells, Goddard, & Hayes, 2004) and implemented in their\nR package, called scPDSI (Zhong, Chen, Wang, & Chengguang, 2018) to\nproduce both the self-calibrating and the conventional Palmer index.\n\n## Using the SPI index \n\nFor illustration use the Nigerian data from Samaru, ***File \\> Open from\nLibrary \\> Instat \\> Browse \\> Climatic \\> Nigeria***, Fig. 12.2a. The\ndata frame, called samaru56t, has already been defined as climatic and\nhas 56 years of daily rainfall data.\n\n  -----------------------------------------------------------------------------------------------------------\n  ***Fig. 18.2a***                                      ***Fig. 18.2b***\n  ----------------------------------------------------- -----------------------------------------------------\n  ![](media/image332.png){width=\"2.754974846894138in\"   ![](media/image312.png){width=\"3.198131014873141in\"\n  height=\"3.516872265966754in\"}                         height=\"3.513098206474191in\"}\n\n  -----------------------------------------------------------------------------------------------------------\n\nThe SPI index is usually used on monthly data, though this is not\nessential. Hence use ***Climatic \\> Prepare \\> Climatic Summaries***, as\nshown in Fig. 18.2b. On the ***Summaries sub-dialogue*** choose the\n***Count not missing*** and the ***Sum***. The monthly totals are shown\nin Fig. 18.2a.\n\n  -----------------------------------------------------------------------------------------------------------\n  ***Fig. 18.2c***                                      ***Fig. 18.2d***\n  ----------------------------------------------------- -----------------------------------------------------\n  ![](media/image319.png){width=\"2.616885389326334in\"   ![](media/image305.png){width=\"3.352402668416448in\"\n  height=\"3.7938856080489938in\"}                        height=\"3.8009251968503937in\"}\n\n  -----------------------------------------------------------------------------------------------------------\n\nNow use Climatic \\> Prepare \\> SPI, Fig. 18.2d. Complete the dialogue as\nshown in Fig. 18.2d, giving the resulting column the name spi1, because\nthe index is for single months.\n\nThen return to the SPI dialogue. Change the time scale to 3 (months) and\nthe name of the resulting column to spi3.\n\nRepeat again, changing the time scale to 12, i.e. to a full year and\nchange the name to spi12.\n\nThe first years of the resulting data are shown in Fig. 18.2e. The\nresults are interpreted and the graphed.\n\nTo help with the interpretation Fig. 18.2f shows boxplots of the monthly\ndata.\n\n+---------------------------------+------------------------------------+\n| ***Fig. 18.2e spi1, spi3 and    | ***Fig. 18.2f***                   |\n| spi12***                        |                                    |\n|                                 | ***Describe \\> Specific Boxplot:   |\n|                                 | sum_rain by month***               |\n+=================================+====================================+\n| ![](media/image321.pn           | ![](media/image33                  |\n| g){width=\"2.8649070428696413in\" | 4.png){width=\"3.175556649168854in\" |\n| height=\"3.703416447944007in\"}   | height=\"3.468993875765529in\"}      |\n+---------------------------------+------------------------------------+\n\nFirst examine March 1928, that has an spi1 index of +2. This has\nresulted from the rainfall total of 52.6mm. Fig. 18.2f shows that this\nis very large for March -- it is the 2^nd^ highest from the 56 years.\nHence positive values of 2 (or more) indicate very rainy compared to the\nnorm. March 1929 had 12.7mm, and the spi1 index of 1.06 indicates that\neven this value is quite large. Often the March total is zero.\n\nAugust 1928 had a modestly negative value of spi1 = -0.456. This was\nfrom the August total of 233mm, and the boxplot indicated that this is\nslightly lower than average. In contrast, August 1929 had 356mm, which\nis higher than the average, and corresponds to the spi1 index of +1.\n\nThe spi3 index fist calculates the 3-month running sums. Hence it\nindicates how they compare with what is expected. For example, from Fig.\n18.2e, April to June 1928 is all each individually higher than expected.\nHence the April to June 1928 total is surprisingly high and has an spi3\nindex of +1.83.\n\nThe 12-month index gives information about the annual (running) totals.\nTo investigate these, use the Climatic \\> Prepare \\> Climatic Summaries\nagain. Change the top button in Fig. 18.2b to Annual to give a data\nframe with 56 values. Now use either ***Prepare \\> Column: Calculations\n\\> Calculate*** or ***Prepare Column: Calculate \\> Column Summaries***\non the ***sum_rain*** variable to show the annual mean is 1068mm and the\nstandard deviation is 178.5mm.\n\nThe total in 1928 was 1262mm. This is higher than the mean of 1068mm and\nhence a positive spi12 value is expected for December 1928 in Fig.\n18.2e. If we standardise the annual total, i.e. evaluate:\n\n(1262 -- mean)/sd = (1262 -- 1068) /178.5 = +1.086, which is close to\nthe spi12value of 1.074.\n\nIn 1929, the total was 1284mm and the standardised value was (1284 --\n1068)/178.5 = 1.21, again close to the spi12 index for December 1929 in\nFig. 18.2e, of 1.18.\n\nThe calculations to produce the spi index is relatively complex. A\ndistribution is fitted to the data and then the equivalents from the\nnormal distribution are found. For the annual totals, the distribution\nis already close to normal, as is shown by the density plot in Fig.\n18.2g. Then the normal distribution is used, as in Fig. 18.2h, where the\nvalue for 1928 is indicated. The results are then standardised, which\njust changes the x-axis in Fig. 18.2h to go from roughly -2 to + 2. In\nfig 18.2h -2 corresponds to a value of 1068 -- 2 \\* 178.5 = 711mm. A\nvalue of 711mm has a probability of 1 year in 40 (probability of about\n0.025) of occurring and represents a severe drought. (Most readers will\nremember the value of ± 1.96, i.e. about ± 2 that gives the 5% points\nfrom the standard normal distribution.)\n\n+----------------------------------+-----------------------------------+\n| ***Fig. 18.2g Density graph of   | ***Fig. 18.2h Normal plot showing |\n| annual totals***                 | 1928 total***                     |\n|                                  |                                   |\n| ***Describe \\> Specific \\>       | ***Model \\> Probability           |\n| Histogram with density***        | Distributions \\> Show Model***    |\n+==================================+===================================+\n| ![](media/image323.p             | ![](media/image335.               |\n| ng){width=\"2.9731157042869643in\" | png){width=\"3.0730129046369203in\" |\n| height=\"3.222425634295713in\"}    | height=\"3.253115704286964in\"}     |\n+----------------------------------+-----------------------------------+\n\nThe indices from Fig. 18.2e can be plotted in a variety of ways. The\n\"standard\" time series graphs look cluttered, as they include the\nseasonality within the graph. Fig. 18.2i presents graphs of spi1 and\nspi12 separately for each of the months. It shows that spi1 is\nmeaningless in the dry months (November to February). Lines at 0 and -2\nhave been added and show largely that any problem is towards the later\nyears.\n\n  -----------------------------------------------------------------------\n  ***Fig. 18.2i***\n  -----------------------------------------------------------------------\n  ![](media/image331.png){width=\"6.113659230096238in\"\n  height=\"3.0128029308836397in\"}\n\n  -----------------------------------------------------------------------\n\n## The SPEI index\n\n[Need to add this section. It works \"trivially\" by giving a\nwater-ba;ance variable instead of the rainfall. So, it could be within\nR-Instat that we just use the Climatic \\> Prepare \\> Transform dialogue\nfirst, to get the water balance, and then return to the SPI\ndialogue.]{.mark}\n\n## Palmer Drought Severity Index\n\n[Check first whether we add it to the dialogue, add another dialogue, or\ntry to give it as a command.]{.mark}","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"Chapter_19_Drought_Indices__SPI.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.45","bibliography":["references.bib"],"theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"Chapter_19_Drought_Indices__SPI.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}