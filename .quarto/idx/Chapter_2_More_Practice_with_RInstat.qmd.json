{"title":"More Practice with R-Instat","markdown":{"headingText":"More Practice with R-Instat","containsRefs":false,"markdown":"## Introduction\n\nTo use climatic data fully it is important to be able to deliver\nproducts. The two examples in this chapter describe the steps and the\nendpoint in this process. Data are supplied in the right form for the\nanalysis. The objectives are specified, and your task is to prepare the\ntables and graphs for a report and a presentation.\n\nSome familiarity with R-Instat is assumed. There are two initial\ntutorials and following those is enough preparation. If you have already\nused a statistics package before, then the examples below may be\nsufficient for you, even without the tutorials. This chapter is also\ndesigned to provide practice with R-Instat.\n\nThe first problem builds on a study in Southern Zambia. This is the most\ndrought-prone area of the country. Everyone knew that there is \\'climate\nchange\\'! Some farmers were emigrating North, citing climate change as\ntheir reason. However, a local non-governmental organization (NGO)\ncalled the Conservation Farming Unit, questioned this reasoning for the\nrainfall data. They are not convinced that any climate change has\nnecessarily affected the farming practices. They, therefore,\ncommissioned a study that used daily climatic data from several stations\nin Southern Zambia. The results were supplied as a report, and\npresentations of the results were also made to the NGO and to the local\nFAO Officers. The results confirmed evidence of climate change in the\ntemperature data, but not in the rainfall. The key conclusions were\nlater made into short plays that were broadcast on local radio and\nplayed at village meetings.\n\nHere we use data from Moorings, a site in Southern Zambia. The daily\ndata, on rainfall, are from 1922 to 2009. Here, partly for simplicity,\nwe largely use the monthly summaries.\n\nFor the work, we draw an analogy with the preparation of a meal. The\nfirst key requirement is that you have the food, which here is the\nclimatic data. In a real meal, the food may be supplied in a form that\nis ready for cooking, or it may need preparation prior to cooking. Here\nthe data are in pre-packed form, so the analysis can proceed quickly.\n\nYou also need the right tools. In a kitchen, they are the saucepans,\netc, while here they are just the computer, together with the required\nsoftware.\n\nYou need some general cooking skills. These are the basic computing\nskills, plus initial skills of R-Instat, at least from the tutorial.\n\nFinally, your objectives must be clear. This corresponds to having a\nspecific meal in mind so that a recipe can be used. Of course, you may\nhave to adapt slightly as you go along. You might find some oddities in\nthe data, just as cooks must improvise if they suddenly find that one of\nthe ingredients is not available.\n\nIf everything is well organized, the cook can prepare the meal very\nquickly. This is just what is done in the products in this chapter. This\nleaves time to make sure the dishes, for us the results, are presented\nattractively. Then users will enjoy consuming what is presented.\n\nSection 2.2 describes the data for this first task. Trends in the\nrainfall are examined in Section 2.3. A second problem, in Section 2.4,\nexamines whether satellite data on sunshine hours resembles\ncorresponding station data. Daily data from Dodoma, Tanzania, are used.\n\nThe data for each of these case studies are in the R-Instat library. The\npresentation is designed so users can repeat the analyses on their\nlaptops.\n\nGraphs are produced in each of these sections and the general methods\nfor graphics in R-Instat is outlined in Section 2.5. Section 3.5 then\nadds a warning. R-Instat provides an easy-to-use click and point way of\nusing the R programming language. It should help users to solve may\nproblems. But a click-and-point system is not the right tool for all\nproblems. We describe a problem that may require more programming\nskills, at least if you wish to prevent your computer from laughing at\nyou!\n\nThis chapter demonstrates R-Instat as a simple general statistics\npackage and the File, Prepare and Describe menus are used. It\nillustrates that a general statistics package is an appropriate tool for\nmany climatic problems. It is also designed to consolidate your\nexperience in using R-Instat. The special climatic menu is introduced in\nchapter 4.\n\n## The Moorings data\n\nMonthly data are used in this part of the chapter. Daily data are the\nstarting point in most of this guide because many of the objectives\nrequire daily data. But here the emphasis is on objectives for which the\nmonthly data are suitable.\n\nThe data are already in an R-Instat file. Hence, they can be opened from\nthe library in R-Instat library.\n\nFrom the opening screen in R-Instat, select ***File \\> Open From\nLibrary*** as shown in Fig. 2.2a. Choose ***Load From Instat\nCollection***, Then ***Browse*** to the ***Climatic*** directory then to\n***Zambia***. ***Select*** the file called ***Moorings_July.rds*** to\ngive the screen shown in Fig. 2.2b. Press ***Ok***.\n\n| ***Fig. 2.2a File \\> Open from Library*** | ***Fig. 2.2b Ready to import Moorings.RDS*** |\n|:----------------------------------------:|:-------------------------------------------:|\n| ***Climatic \\> Zambia \\> Moorings.RDS*** |                                             |\n| ![](figures/Fig2.2a.png){width=\"3.36in\" height=\"3.06in\"} | ![](figures/Fig2.2b.png){width=\"2.43in\" height=\"2.75in\"} |\n\nThe resulting data are shown in Fig. 2.2c. There are 2 data frames. The\none called Moorings has daily data.\n\n***Move to the second data frame*** as shown in Fig. 2.2c which shows\nthe monthly totals. They are the total rainfall in mm and the total\nnumber of rain days. A rain day was defined as a day with more than\n0.85mm[^1].\n\n| ***Fig. 2.2c The Moorings monthly data*** | ***Fig. 2.2d Boxplot dialogue on the Describe menu*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n|                                           | ***Describe \\> Specific \\> Boxplot***                 |\n| ![](figures/Fig2.2c.png){width=\"1.844in\" height=\"3.474in\"} | ![](figures/Fig2.2d.png){width=\"3.096in\" height=\"2.329in\"} |\n\nRainfall in Southern Zambia is from November to April. Hence, we analyze\nthe data by season, rather than by year. There are 88 seasons from 1922\nto 2009 and 1056 monthly values, as indicated in Fig. 2.2c.\n\nThe task is to write a short report that describes the patterns of\nrainfall. One aim is to assess whether there is obvious evidence of\nchange in the pattern of rainfall. This evidence might justify\nrequesting the data from multiple stations, to undertake a more detailed\nstudy. The first step is to explore the data, and then consider how\nappropriate results could be presented. To explore we start with a\nboxplot to show the seasonal pattern of the rainfall totals.\n\nChoose the Boxplot dialogue from the Describe menu, with ***Describe \\>\nSpecific \\> Boxplot***, as shown in Fog. 2.2d. Complete the dialogue as\nshown in Fig. 2.2e. The resulting graph is shown in Fig. 2.2f[^2]. This\nshows the total rainfall was typically 200mm in each of December to\nFebruary. There was always some rain in each of these months, and the\nrecords were over 500mm.\n\n\n| ***Fig. 2.2e Completed boxplot dialogue*** | ***Fig. 2.2f Boxplot of monthly rainfall totals*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ***Describe \\> Specific \\> Boxplot***    |                                                      |\n| ![](figures/Fig2.2e.png){width=\"3.101in\" height=\"3.540in\"} | ![](figures/Fig2.2f.png){width=\"2.966in\" height=\"3.095in\"} |\n\nChange the variable from rain to ***raindays*** in Fig. 2.2e to give the\ncorresponding boxplots for the number of raindays in the month, Fig.\n2.2g. This shows that typically one day in two are rainy in December to\nFebruary. Occasionally most of the days are rainy.\n\nBoxplots are essentially a 5-number summary of the data, (with potential\noutliers also shown). The ***Prepare \\> Column: Reshape \\> Column\nSummaries, Fig. 2.2h,*** dialogue can provide the same summaries\nnumerically.\n\n\n| ***Fig. 2.2g The number of rain days*** | ***Fig. 2.2h Summary dialogue on the Prepare menu*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n|   ![](figures/Fig2.2g.png){width=\"3.281in\" height=\"3.440in\"} | ![](figures/Fig2.2h.png){width=\"2.724in\" height=\"2.691in\"}|\n\nSummarise both the monthly totals and the number of raindays, with the\nmonth as the factor, as shown in Fig. 2.2i. Then choose the Summaries\nbutton and complete the sub-dialogue as shown in Fig. 2.2j.\n\n| ***Fig. 2.2i Summary dialogue*** | ***Fig. 2.2j Summaries sub-dialogue*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ***Prepare \\> Column: Reshape \\> Column Summaries***    |                                      |\n| ![](figures/Fig2.2i.png){width=\"3.206in\" height=\"3.343in\"} | ![](figures/Fig2.2j.png){width=\"2.734in\" height=\"3.674in\"} |\n\nThe results are in a third data frame. It just has 12 rows as shown in\nFig. 2.2k. The summaries are clearer if they are in order (which we did\nalready for Fig. 2.2k).\n\n***Right-click in the name field*** of this data frame and choose the\noption to ***Reorder columns***, Fig. 2.2l.\n\n| ***Fig. 2.2k Resulting summary data*** | ***Fig. 2.2l Right-click menu to reorder columns*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ![](figures/Fig2.2k.png){width=\"3.517in\" height=\"2.443in\"} | ![](figures/Fig2.2l.png){width=\"2.419in\" height=\"2.464in\"} |\n\nIn the Reorder dialogue, use the ***arrow keys*** to change the position\nof the columns in the data frame.\n\nWith the summaries in a sensible order, they are now transferred to the\nresults (output) window.\n\n| ***Fig. 2.2m Reorder the resulting columns*** | ***Fig. 2.2n Simplify column names*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ***Right-click \\> Reorder column(s)***    | ***Right-click \\> Rename column(s)***             |\n| ![](figures/Fig2.2m.png){width=\"3.098in\" height=\"2.219in\"} | ![](figures/Fig2.2n.png){width=\"3.026in\" height=\"2.083in\"} |\n\nBefore this, we renamed some of the columns to give shorter names. This\nagain used the ***right-click*** menu, Fig 2.2l. The rename dialogue is\nshown in Fig. 2.2n.\n\n| ***Fig. 2.2o View Data dialogue*** | ***Fig. 2.2p The Monthly number of rain days*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ***Prepare \\> Data Frame \\> View Data***    |                                                 |\n| ![](figures/Fig2.2o.png){width=\"2.712in\" height=\"2.720in\"} | ![](figures/Fig2.2p.png){width=\"3.378in\" height=\"2.302in\"} |\n\nNow use the ***Prepare \\> Data Frame \\> View Data*** dialogue, Fig.\n2.2o, to transfer the rainfall totals and then the number of rain days\nto the results window. The results for the number of rain days are shown\nin Fig. 2.2p.\n\n## The objectives\n\nSection 2.2 explored the data and examined the seasonal pattern of the\nrainfall at Moorings. It also made use of the three menus, File, Prepare\nand Describe and well as the right-click menu. The main objective,\nhowever, was to see if there is evidence of rainfall change rather than\nto investigate the seasonal pattern.\n\nWe first examine the annual totals and the total number of rain days.\nThese are the totals from July to June, so they cover each season.\n\nSome \"housekeeping\" is a preliminary. The 3^rd^ data-frame is no longer\nneeded. Right-click on the bottom tab a and choose the option to delete,\nFig. 2.3a. The dialogue shown in Fig. 2.3b opens. Just press ok.\n\n| ***Fig. 2.3a Right-click on the bottom tab*** | ***Fig. 2.3b Delete a data frame*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ![](figures/Fig2.3a.png){width=\"2.15in\" height=\"1.688in\"} | ![](figures/Fig2.3b.png){width=\"3.808in\" height=\"2.323in\"} |\n\nUse ***Prepare \\> Column: Reshape \\> Column Summaries*** and complete\nthe dialogue and sub-dialogue as shown in Fig. 2.3c and Fig. 2.3d to\nproduce the seasonal totals.\n\n| ***Fig. 2.3c Produce the annual totals*** | ***Fig. 2.3d The Summaries sub-dialogue*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ***Prepare \\> Column: Reshape \\> Column Summaries***    |                                                 |\n| ![](figures/Fig2.3c.png){width=\"3.194in\" height=\"3.340in\"} | ![](figures/Fig2.3d.png){width=\"2.831in\" height=\"3.806in\"} |\n\nThe results are shown in Fig. 2.3 e after the steps explained below.\nFirst, notice in Fig. 2.3e that there were only 4 months in the first\nseason, and the annual summary was therefore set to missing[^3].\n\n| ***Fig. 2.3e Resulting annual data*** | ***Fig. 2.3f Menu for a text substring*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ![](figures/Fig2.3e.png){width=\"2.941in\" height=\"3.522in\"} | ![](figures/Fig2.3f.png){width=\"3.028in\" height=\"2.812in\"} |\n\nA numeric column for the year (season) is needed for the time series\ngraphs. Hence, as shown below, we produce the second column, called\ns_yr, also shown in Fig. 2.3e.\n\nUse ***Prepare \\> Column: Text \\> Transform***, Fig. 2.3f. Complete the\nresulting dialogue, as shown in Fig. 2.3g, to give just the starting\nyear of the season. The resulting variable is shown in Fig. 2.3e.\n\n| ***Fig. 2.3g The Substring Option*** | ***Fig. 2.3h Convert Column to Numeric*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ***Prepare \\> Column: Text \\> Transform***    |                                                 |\n| ![](figures/Fig2.3c.png){width=\"3.460in\" height=\"3.001in\"} | ![](figures/Fig2.3d.png){width=\"2.004in\" height=\"2.891in\"} |\n\nUse the ***right-click*** menu, Fig. 2.3h to convert the resulting s_yr\ncolumn to numeric.\n\nAfter a little further housekeeping from the right-click menu, to\n***rename***, ***re-orde***r and ***delete*** columns, the annual data\nare as shown in Fig. 2.3e above.\n\nNow for the time-series graphs. They can be produced using the\n***Describe \\> Specific \\> Line Plot*** dialogue, but this type of graph\nis just what is needed for the PICSA-style rainfall graphs, so we use\nthe special climatic menu for the first time.\n\nUse ***Climatic \\> PICSA \\> Rainfall Graph***. Complete as shown in Fig.\n2.3i. Press the **PICSA Options** button and complete the Lines ab as\nshown in Fig. 2.3j to add (and label) a horizontal line for the mean.\n\n| ***Fig. 2.3i PICSA Rainfall graph dialogue*** | ***Fig. 2.3j Add a line showing the mean*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ***CLimatic \\> PICSA \\> Rainfall Graph***    |                                                 |\n| ![](figures/Fig2.3c.png){width=\"2.796in\" height=\"3.340in\"} | ![](figures/Fig2.3d.png){width=\"3.264in\" height=\"2.318in\"} |\n\nThe resulting graph is shown in Fig 2.3k[^4]. ***Return to the\ndialogue*** and put ***raindays*** as the y-variable to give the results\nin Fig. 2.3l.\n\n| ***Fig. 2.3k Seasonal rainfall totals*** | ***Fig. 2.3l Number of rain days*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ![](figures/Fig2.3k.png){width=\"3.017in\" height=\"1.502in\"} | ![](figures/Fig2.3l.png){width=\"2.872in\" height=\"1.429in\"} |\n\nThese graphs indicate large inter-annual variability, but they don't\nseem to show a trend. That is important because, if you can attribute\nyour farming problems to climate change, then there may be nothing you\ncan do. But coping with the variability is what farmers have always had\nto do.\n\nWith results such as shown in Fig. 2.3k and 2.3l you can start comparing\nrisks for different options in your farming and in other enterprises.\nThat sort of idea is discussed in PICSA workshops.\n\nSome may find the graph shown above to be convincing evidence that, with\nrainfall, the pressing problem is variability, rather than change. We\nstress that there IS climate change, and similar graphs with temperature\ndata show a trend. If the temperatures have changed, then the \"system\"\nhas changed, and it follows that other elements including rainfall will\nbe affected. Currently, however, with this sort of analysis, it is\nusually not yet possible to determine which way the pattern of rainfall\nmay change. It is difficult to detect a small change when the\ninter-annual variability is so large. And, even if a change is detected,\ncoping as well as possible with the variability must be a good thing to\ndo.\n\nSome people are not convinced by graphs such as are shown above. A\ncommon statement is that the annual totals that might still be similar,\nbut the season is shorter, because planting is delayed, etc. We examine\nthis in more detail in Chapter 7. There the daily data are used to\ndefine the start, end and length of the season as well as to examine dry\nspells and extremes during the season. With the monthly total, the\nexamination can start by repeating the analysis above, but just for\nNovember and December, when the season starts.\n\n***Return to the monthly data frame*** and ***filter*** to examine just\nthose months. So, make sure you are on the monthly data. ***Right\nclick*** as usual and choose ***Filter***, Fig. 2.3m\n\n| ***Fig. 2.3m Right-click for Filter*** | ***Fig. 2.3n The filter dialogue*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ![](figures/Fig2.3c.png){width=\"2.886in\" height=\"6.250in\"} | ![](figures/Fig2.3l.png){width=\"6.944in\" height=\"3.659in\"} |\n\n\n  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  ***Fig. 2.3m Right-click for Filter***                  ***Fig. 2.3n The filter dialogue***\n  ------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------\n  ![](media/image1104.png){width=\"2.8858759842519683in\"   ![](media/image1106.png){width=\"6.944444444444444e-3in\" height=\"6.250328083989501e-2in\"}![](media/image1106.png){width=\"6.944444444444444e-3in\"\n  height=\"3.6586843832021in\"}                             height=\"6.250328083989501e-2in\"}![C:\\\\Users\\\\ROGERS\\~1\\\\AppData\\\\Local\\\\Temp\\\\SNAGHTML1993cb5.PNG](media/image1107.png){width=\"3.2437456255468065in\"\n                                                          height=\"3.2540988626421696in\"}\n\n  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nIn Fig. 2.3n, click to ***Define new Filter***. Complete the\nsub-dialogue as shown in Fig. 2.3o. The steps are as follows:\n\n1)  ***Choose the month*** column\n\n2)  ***Select Nov and Dec*** as shown in Fig. 2.3p\n\n3)  Click to ***Add Condition***\n\n4)  Press ***Return***\n\n| ***Fig. 2.3o Define the filter*** | ***Fig. 2.3p The filtered data*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ***Prepare \\> Column: Reshape \\> Column Summaries***    |                                                 |\n| ![](figures/Fig2.3o.png){width=\"3.992in\" height=\"2.858in\"} | ![](figures/Fig2.3p.png){width=\"2.056in\" height=\"2.975in\"} |\n\n\nBack on the main filter dialogue, just ***press Ok***. The data are now\nas shown in Fig. 2.3p. The first column is in red and this shows a\nfilter is in operation. Also, at the bottom of the data frame, you see\nthere are now 176 rows (months) of data to analyse, out of the original\n1062 rows.\n\nThe other data have not gone away. If ever you wish to return, then just\npress right-click as before, Fig. 2.3m and choose the last option to\n***Remove Current Filter***.\n\nNow it is quick to repeat the steps above for this analysis. It is\nsimpler to recall the last dialogues as shown in Fig. 2.3q.\n\n| ***Fig. 2.3q Recall the last dialogues*** | ***Fig. 2.3r The Column Statistics dialogue*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n|![](figures/Fig2.3q.png){width=\"2.604in\" height=\"2.746in\"} | ![](figures/Fig2.3r.png){width=\"3.315in\" height=\"3.458in\"} |\n\nThe Column Statistics dialogue and sub-dialogue remain completed from\nbefore, Fig. 2.3r. So just ***press Ok***.\n\nThe new columns have added to the existing annual sheet. So, go straight\nto the PICSA Rainfall Graphs dialogue again. ***Choose the new\nvariable*** for the November-December totals and press OK. The mean is\nnow 286mm for the 2 months. Repeat for the number of rain days to give\nthe graphs for the filtered data, see Fig. 2.3s and 2.3t.\n\n| ***Fig. 2.3s Rainfall totals Nov-Dec*** | ***Fig. 2.3t Number of rain days Nov-Dec*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n|![](figures/Fig2.3s.png){width=\"2.967in\" height=\"1.476in\"} | ![](figures/Fig2.3t.png){width=\"3.032in\" height=\"1.509in\"} |\n\n\nOne feature of the data in Fig. 2.3s is that had the record started in\n1981, then it might have given an impression of an upward trend in the\nrainfall total. The longer record shows that this sort of conclusion\nshould be treated with considerable caution!\n\nThese graphs start to satisfy the objective of examining the rainfall\ndata in Southern Zambia for trends. The results should be considered as\nprovisional if only because they are from just a single station and only\nuse the monthly data. We suggest they make a case for a more complete\nanalysis with multiple stations.\n\n## Comparing satellite and station data\n\nOur proposed objective is to report on the feasibility of using\nsatellite estimates of sunshine hours to supplement the information from\nstation data. The station network for sunshine or radiation is sparse in\nmany countries. Where it exists the records often have many missing\nvalues.\n\nEstimates of daily hours of sunshine are also available from the\nEUMETSAT CMSAF (Climate Monitoring Satellite Application Facility) for\nabout 5km square pixels. The data are available from 1983 and may be\ndownloaded free of charge. These data are in NetCDF files and examples\nfrom a few locations have been downloaded and are the R-Instat library.\n\nData from Dodoma, Tanzania was analysed in the second tutorial and the\nsame dataset is used here. In this exercise, these data are merged with\nthe corresponding satellite data and the two variables are then\ncompared.\n\nAs in the tutorial use ***File \\> Open From Library***. Choose the\n***Instat collection***. Browse to the ***Climatic directory*** and\nchoose the ***Original Climatic Guide datasets***. Choose just the\n***Dodoma*** sheet, Fig. 2.4a.\n\n| ***Fig. 2.4a Importing the Dodoma data*** | ***Fig. 2.4b The Summaries sub-dialogue*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ![](figures/Fig2.4a.png){width=\"3.179in\" height=\"2.681in\"} | ![](figures/Fig2.4b.png){width=\"2.830in\" height=\"2.695in\"} |\nOnce imported use ***Prepare \\> Column: Date \\> Make Date***, Fig. 2.4b\nto construct a date column from the Year, Month, Day columns. Name the\nresulting column as ***Date***, see Fig. 2.4b.\n\nNow use ***File \\> Import and Tidy NetCDF File***, Fig. 2.4c. Choose the\noption ***From Library*** and the file that starts ***CMSAF_SDU*** (for\nsunshine duration). This file contains just the data from the nearest\npixel to the Dodoma station data.\n\n| ***Fig. 2.4c Import the CMSAF Satellite data*** | ***Fig. 2.4d Change the name to Date*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n|![](figures/Fig2.4c.png){width=\"2.988in\" height=\"1.781in\"} | ![](figures/Fig2.4d.png){width=\"3.040in\" height=\"1.774in\"} |\n\n\nOnce imported, ***right-click*** to change the name of the last column\nfrom ***time_date*** to ***Date***, i.e. to the same name as in the\nstation data, Fig. 2.4d[^5].\n\n| ***Fig. 2.4e The Merge dialogue*** | ***Fig. 2.4f Sub-dialogue to add just SDU*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ![](figures/Fig2.4e.png){width=\"3.111in\" height=\"2.508in\"} | ![](figures/Fig2.4f.png){width=\"3.245in\" height=\"2.277in\"} |\n\nUse ***Prepare \\> Column: Reshape \\> Merge*** and complete the dialogue\nas shown in Fig. 2.4e. It chooses to match on the Date columns, which is\nwhat we want. That is why we gave them the same name in the two data\nframes[^6].\n\nThe SDU column is all we need from the satellite data. So, press the\n***Merge Options*** button in Fig. 2.4e. Use the ***Columns to\nInclude*** tab and complete as shown in Fig. 2.4f. Press ***Return***\nand then Ok.\n\nNow check, using ***Describe \\> One Variable \\> Summarise*** on the\nmerged data. Choose all the columns and press Ok. The results are in\nFig. 2.4g.\n\n| ***Fig. 2.4g Results from One Variable Summarise*** | ***Fig. 2.4h Generate columns from the Date*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ***Describe \\> One Variable \\> Summarise***    |  ***Prepare \\> Column: Date \\> Make Date*** \n| ![](figures/Fig2.4g.png){width=\"3.249in\" height=\"2.516in\"} | ![](figures/Fig2.4h.png){width=\"2.799in\" height=\"3.594in\"} |\n\nAn encouraging sign in Fig. 2.4g is that summary statistics for the Sunh\n(from the station) and SDU (from the satellite) are almost identical.\nThe maximum of 16 hours for SDU is a little concerning, because that is\nprobably longer than the maximum day length at Dodoma.\n\nSome \"housekeeping\" is useful, because the results in Fig. 2.4g also\nshow there are some missing values in the year and day of month\ncolumn[^7].\n\n***Right-click*** and ***delete the first 3 columns***. Then generate\nthem again (without missing values) using ***Prepare \\> Column: Date \\>\nUse Date*** dialogue, Fig. 2.4h. Then use Describe \\> One Variable \\>\nSummarise again to confirm the new columns do not have missing values.\n\n| ***Fig. 2.4i Resulting merged data*** | ***Fig. 2.4j Correlations dialogue*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ![](figures/Fig2.4g.png){width=\"3.285in\" height=\"2.760in\"} | ![](figures/Fig2.4j.png){width=\"2.792in\" height=\"2.812in\"} |\n\n***Right-Click*** and choose ***Reorder Column(s)***. The resulting data\nshould be like that shown in Fig. 2.4i.\n\nWe are now ready to compare the satellite data (SDU) with the station\nvalues (sunh).\n\n| ***Fig. 2.4k Correlations sub-dialogue*** | ***Fig. 2.4l Results*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ![](figures/Fig2.4k.png){width=\"2.906in\" height=\"3.124in\"} | ![](figures/Fig2.4l.png){width=\"3.094in\" height=\"3.094in\"} |\n\nUse ***Describe \\> Multivariate \\> Correlations***. and enter SDU and\nsunh, Fig. 2.4j. Click on ***Options*** and choose ***Scatter Matrix***.\nFig. 2.4k. The results are in Fig. 2.4l.\n\nThe results in Fig. 2.4l look promising. The shape of the satellite\n(bottom right) and station data (top left) look similar and the\ncorrelation is a reasonably satisfactory 0.87.\n\nWhat is next? These data (both sunh and SDU) are time series. Time\nseries have seasonality, and this should usually be reflected in the\nanalysis.\n\nSo, return to the ***correlations dialogue*** and sub-dialogue, Fig.\n2.4k and ***add the month factor***.\n\n| ***Fig. 2.4m Including months in the analysis*** | ***Fig. 2.4n The Histogram dialogue*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n|![](figures/Fig2.4m.png){width=\"2.931in\" height=\"2.931in\"} | ![](figures/Fig2.4n.png){width=\"3.064in\" height=\"2.494in\"} |\n\nThe results in Fig. 2.4m show that the shape of both variables depends\non the month. In particular (as expected) there is often less sun in the\nrainy season (November to April) and the correlations are then higher.\nThe display, in Fig. 2.4m, is also confusing as there are now too many\ngroups to see clearly what is happening.\n\nIt is time to split up the components of the results in Fig. 2.4m to\ncompare the satellite and station data in more detail.\n\nUse ***Describe \\> Specific \\> Histogram***, Fig. 2.4n.\n\n| ***Fig. 2.4o A set of density graphs*** | ***Fig. 2.4p Include facets in the graph*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ![](figures/Fig2.4o.png){width=\"2.856in\" height=\"2.822in\"} | ![](figures/Fig2.4p.png){width=\"3.222in\" height=\"2.833in\"} |\n\n\nChange the button at the top of Fig. 2.4o to Density and click on Plot\nOptions.\n\nIn the sub-dialogue, Fig. 2.4p tick the checkbox to include facets and\ninclude the month factor.\n\n| ***Fig. 2.4q Multiple variables*** | ***Fig. 2.4r Resulting graphs*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ***Describe \\> One Variable \\> Summarise***    |  ***Prepare \\> Column: Date \\> Make Date*** \n| ![](figures/Fig2.4q.png){width=\"1.838in\" height=\"1.876in\"} | ![](figures/Fig2.4r.png){width=\"4.200in\" height=\"2.090in\"} |\n\n\nReturn to the main dialogue, and click to include multiple variables,\nFig. 2.4q. Include Sunh and SDU and press Ok. The graphs from Fig. 2.4m\nare now overlaid, so they can easily be compared, and displayed\nseparately for each month. Fig. 2.4r shows the pattern is similar in\neach month. We also see the sharp peaks in the dry months, particularly\nfrom June to October, when most days have about 10 hours of sunshine per\nday.\n\nFig. 2.4r shows the pattern of sunshine is similar from the satellite\nand station data. It does not, however, show whether a day in any month\nwith more sunshine at the station (sunh), also had more sunshine from\nthe satellite data (SDU). For this, we look at the scatterplot from Fig.\n2.4m again broken into the monthly facets.\n\nUse ***Describe \\> Specific \\> Scatterplot*** and complete the dialogue\nas shown in Fig. 2.4s. Press on ***Plot Options*** and include the\nmonths as facets, Fig. 2.4t, just as earlier in Fig. 2.4p.\n\n| ***Fig. 2.4s Scatterplot dialogue*** | ***Fig. 2.4t Plotting sub-dialogue*** |\n|:----------------------------------------:|:---------------------------------------------------:|\n| ![](figures/Fig2.4g.png){width=\"3.050in\" height=\"2.945in\"} | ![](figures/Fig2.4h.png){width=\"2.893in\" height=\"2.466in\"} |\n\nThe resulting set of graphs is shown in Fig. 2.4u.\n\n  -----------------------------------------------------------------------\n  ***Fig. 2.4u Scatterplots for each month***\n  -----------------------------------------------------------------------\n  ![](figures/Fig2.4u.png){width=\"6.131447944006999in\"\n  height=\"3.0514577865266843in\"}\n\n  -----------------------------------------------------------------------\n\nOur initial objective was to examine whether the satellite estimates may\nbe useful in Tanzania to supplement the station data. The results are\npromising, but this just the start. There are many possible next steps,\nincluding an examination of the occasions when the two variables differ\nsubstantially. The analysis should also be extended to multiple\nstations. We also need more numerical summaries to measure how close the\ntwo variables are. Chapter 10 considers this subject in more detail.\n\n## In conclusion\n\n[To be added]{.mark}","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"Chapter_2_More_Practice_with_RInstat.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.45","bibliography":["references.bib"],"theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"Chapter_2_More_Practice_with_RInstat.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}