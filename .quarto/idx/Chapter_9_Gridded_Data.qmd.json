{"title":"Gridded Data","markdown":{"headingText":"Gridded Data","containsRefs":false,"markdown":"## Introduction\n\nThere are various sources of gridded data for climatic elements. Those\nconsidered here are from the European Organisation for the Exploitation\nof Meteorological Satellites, Satellite Application Facility on Climate\nMonitoring (EUMETSAT CM SAF), the Copernicus Climate Change Service\n(C3S) Climate Data Store and the International Research Institute for\nClimate and Society (IRI) Data Store.\n\nAll data are freely available. You need to register to access data from\nCM SAF, and also for the C3S Climate Data Store. The IRI Data Store does\nnot require registration. The CM SAF data considered here are from\nstationary satellites and are available for all of Europe and Africa and\npossibly more, e.g. Middle East and Caribbean. Sunshine and radiation\ndata are illustrated here. They are available daily (some hourly) on a\ngrid of about 4km and are from 1983. Other elements, e.g. ground\ntemperature are available hourly, from the early 1990s. They will later\nbecome available from the 1980s.\n\nWe consider the ERA5 reanalysis data from the C3S Climate Data Store.\nERA5 is global, from 1979 (soon to be 1950) with a large number of\nelements available hourly on a grid of 0.25 by 0.25 degrees (about\n30km). It is illustrated with precipitation (hourly) and with 2m\ntemperature (used to derive daily Tmax and Tmin).\n\nThe IRI Data Store is a repository of climate data from a wide variety\nof sources. We illustrate the IRI Data Store by accessing daily\nprecipitation estimates from CHIRPS and ENSO and sea-surface\ntemperatures, that are commonly used for seasonal forecasting.\n\nThere are many possible uses and applications of these data. [To be\ncontinued -- with examples of what can be done and is being\ndone.]{.mark}\n\n## Importing NetCDF files\n\nShow how to use the dialog first without changing options but still look\nat details to check what is being imported.\n\nThen show the options for sub-areas, an individual station, or for\nmultiple stations. Can use Rwanda station locations and CHIRPS data from\nIRI section.\n\n## EUMETSAT CM SAF\n\nThe CM SAF website is shown in Fig. 9.2a. You are invited to sign-in or\nregister, though you are welcome to explore what is available without\nthis. You need to register to download any data. You are then able to\nuse these data freely. EUMETSAT would very much welcome any feedback on\nhow the data have been used, particularly if, for example, you have\ncompared your station data with their data. They may sometimes be\nprepared to assist you with using the data. You can contact EUMETSAT\nthrough their User Help Desk\n[[https://www.cmsaf.eu/EN/Service/UHD/UHD_node.html]{.underline}](https://www.cmsaf.eu/EN/Service/UHD/UHD_node.html).\n\n  -----------------------------------------------------------------------\n  ***Fig. 9.2a***\n  -----------------------------------------------------------------------\n  ![](figures/Fig9.2a.png){width=\"6.268055555555556in\"\n  height=\"2.9381944444444446in\"}\n\n  -----------------------------------------------------------------------\n\nChoose Surface Radiation products from the Climate Data Records menu in\nFig. 9.2a. Choose daily sunshine duration, SDU, Fig. 9.2b.\n\nFrom Fig. 9.2c we see the data are available from 1 January 1983 to the\nend of December 2017 (when this guide was written). There are other\nproducts from EUMETSAT CM SAF if more recent data are required, but they\nhave not been through the homogenisation and quality control checks.\n\n  -----------------------------------------------------------------------------------------------------------\n  ***Fig 9.2b***                                        ***Fig. 9.2c***\n  ----------------------------------------------------- -----------------------------------------------------\n  ![](figures/Fig9.2b.png){width=\"3.133465660542432in\"   ![](figures/Fig9.2c.png){width=\"2.911786964129484in\"\n  height=\"2.4349464129483813in\"}                        height=\"2.7217924321959757in\"}\n\n  -----------------------------------------------------------------------------------------------------------\n\nAlso indicated in Fig. 9.2c is that there is documentation on each\nproduct. Consider downloading these guides if you decide to use the data\nas they are very detailed and informative.\n\nOn the same screen as Fig. 9.2c you see an ***Add to Order Cart***\ninvitation. Ignore this for now, unless you want a huge file, with data\nfrom about half the globe.\n\nInstead, scroll further down and click on the button that says ***Change\nProjection / spatial resolution / domain***.\n\n  -------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.2d***                                        ***Fig. 9.2e***\n  ------------------------------------------------------ ------------------------------------------------------\n  ![](figures/Fig9.2d.png){width=\"2.1938396762904637in\"   ![](figures/Fig9.2e.png){width=\"3.9405238407699037in\"\n  height=\"2.021411854768154in\"}                          height=\"1.5502766841644795in\"}\n\n  -------------------------------------------------------------------------------------------------------------\n\nIf you are following this as an exercise, then change the coordinates in\nFig. 9.2e.\n\nClick, in Fig. 9.2e to proceed to the time range selection.\n\n  -------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.2f***                                        ***Fig. 9.2g***\n  ------------------------------------------------------ ------------------------------------------------------\n  ![](figures/Fig9.2f.png){width=\"3.1262707786526684in\"   ![](figures/Fig9.2g.png){width=\"2.9971336395450567in\"\n  height=\"2.611187664041995in\"}                          height=\"1.376020341207349in\"}\n\n  -------------------------------------------------------------------------------------------------------------\n\nIn the following screen, scroll down to confirm that the sub-domain,\npart of Rwanda, has been included, Fig. 9.2f. Then press Add to Order\nCart, Fig. 9.2g.\n\nYou return to the screen in Fig. 9.2h. It is disconcerting that in Fig.\n9.2h it appears you are about to order a file of over 200 gigabytes, but\nit is the size ignoring the sub-domain[^46]. Keep your nerve and place\nthe order, Fig. 9.2h.\n\n  -----------------------------------------------------------------------\n  ***Fig.9.2h***\n  -----------------------------------------------------------------------\n  ![](figures/Fig9.2h.png){width=\"6.152322834645669in\"\n  height=\"2.709448818897638in\"}\n\n  -----------------------------------------------------------------------\n\nYou receive a confirmatory e-mail that the order has been placed on the\nEUMETSAT server. Shortly afterwards there is confirmation that the data\nhave been extracted and are waiting to be downloaded, Fig. 9.2i\n\n  -----------------------------------------------------------------------\n  ***Fig. 9.2i***\n  -----------------------------------------------------------------------\n  ![](figures/Fig9.2i.png){width=\"6.101929133858268in\"\n  height=\"2.9671358267716537in\"}\n\n  -----------------------------------------------------------------------\n\nFollow the instructions in your equivalent of the message in Fig. 9.2i\nto download the file. It is now, for the first time that you are made\naware of the file size, 341 Mbytes for this example.\n\nThis downloads a single tar file, containing 12 thousand individual\nNetCDF files, with one file for each day.\n\nThis is continued, in Section 9.5, through the CM SAF toolbox and in\nSection [xxx]{.mark} using R-Instat.\n\n## C3S Climate Data Store\n\nIf you are not online, then the first part of this section is again for\nreading only.\n\nThe website is <https://cds.climate.copernicus.eu/>. This takes you to\nthe screen partly shown in Fig. 9.3a. You are invited to login or\nregister your account. So, do this.\n\nOnce logged in you return to the screen in Fig. 9.3a.\n\n  -----------------------------------------------------------------------\n  ***Fig. 9.3a***\n  -----------------------------------------------------------------------\n  ![](figures/Fig9.3a.png){width=\"6.124782370953631in\"\n  height=\"2.761784776902887in\"}\n\n  -----------------------------------------------------------------------\n\nThen click on Datasets in Fig. 9.3a to give the screen starting in Fig.\n9.3b. There are many different datasets available. In the search bar\ntype \"ERA5 hourly\" and from the results select, \"ERA5 hourly data on\nsingle levels\".\n\nClick on this dataset to get further information, see Fig. 9.3c.\n\n  ------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.3b***                                       ***Fig. 9.3c***\n  ----------------------------------------------------- ------------------------------------------------------\n  ![](figures/Fig9.3b.png){width=\"3.026570428696413in\"   ![](figures/Fig9.3c.png){width=\"3.0448775153105863in\"\n  height=\"1.5810192475940508in\"}                        height=\"2.0040441819772528in\"}\n\n  ------------------------------------------------------------------------------------------------------------\n\nThe data are currently from 1979 (soon to be from 1950). They are\navailable for many elements including precipitation, temperature,\nevaporation, radiation and wind speed and direction.\n\nThey are hourly data and at a 0.25 by 0.25-degree (about 25km)\nresolution.\n\n  ------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.3d***                                       ***Fig. 9.3e***\n  ----------------------------------------------------- ------------------------------------------------------\n  ![](figures/Fig9.3d.png){width=\"3.128680008748906in\"   ![](figures/Fig9.3e.png){width=\"2.8662554680664916in\"\n  height=\"2.0612062554680666in\"}                        height=\"2.2056594488188974in\"}\n\n  ------------------------------------------------------------------------------------------------------------\n\nOn your first visit to the site, continue, and click on ***Download\ndata*** in Fig. 9.3c. You then choose one or more elements, Fig. 9.3d\nand decide on the years, months, days and hours to include. Finally,\nselect the sub-region to extract in the Geographical area section, Fig.\n9.3f. Once the items in Fig. 9.3d, Fig. 9.3e and Fig. 9.3f are complete\nyou can click ***Submit Form*** to start the request.\n\nThe running may take minutes (sometimes many) to complete. It also\nsometimes fails. You can view the current status of your requests by\nclicking ***Your requests*** from the menu bar shown in Fig. 9.3a.\nOccasionally there is a single error 500, in which case just run again.\nThe other common error is that you have asked for too much data. If you\nare requesting a complete time series i.e. for all hours, days, and\nmonths, then the current limit appears to be approximately 5 years. This\nlimit seems to be the same, irrespective of the area. Hence, for 30\nyears, make 6 separate requests, changing the years for each run. You do\nnot need to wait for a request to complete before starting another one.\nGo to ***Your requests*** to see the status of each and download the\ndata once complete.\n\n  -------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.3f Generate a toolbox request***             ***Fig. 9.3g Names for each element***\n  ------------------------------------------------------ ------------------------------------------------------\n  ![](figures/Fig9.3f.png){width=\"3.0120089676290465in\"   ![](figures/Fig9.3g.png){width=\"3.0938626421697286in\"\n  height=\"2.827140201224847in\"}                          height=\"1.705543525809274in\"}\n\n  -------------------------------------------------------------------------------------------------------------\n\nAn alternative way to request data is through the Toolbox, shown in the\nmenu bar of the homepage in Fig. 9.3a. Previously, it was not possible\nto select a sub-region through the interface described above, hence it\nwas necessary to construct a Python script to run the Toolbox in order\nto do this. However, now that sub-region extraction is possible in the\ninterface, we suggest it is sufficient to use the interface if your main\ninterest is to download data for use in another software e.g. R or\nR-Instat.\n\nAn example Toolbox script to download hourly 2-metre temperature data\nfor sub-region covering in Rwanda for 5 years in shown Fig. 9.3i. The\nToolbox also includes functionality for processing, analysing and\ndisplaying data, however this is not covered here as we will demonstrate\nimporting ERA5 data into R-Instat.\n\n+-----------------------------------------------------------------------+\n| ***Fig. 9.3h Sample toolbox code***                                   |\n+=======================================================================+\n| **import cdstoolbox as ct**                                           |\n|                                                                       |\n| **\\@ct.application(title=\\'Retrieve Data\\')**                         |\n|                                                                       |\n| **\\@ct.output.dataarray()**                                           |\n|                                                                       |\n| **def retrieve_sample_data():**                                       |\n|                                                                       |\n| **\\\"\\\"\\\"**                                                            |\n|                                                                       |\n| **Application main steps:**                                           |\n|                                                                       |\n| **- retrieve 2m temperature of ERA5 from CDS Catalogue**              |\n|                                                                       |\n| **- specify the grid - year(s) - month(s) - day(s) - hour(s)**        |\n|                                                                       |\n| **- area is optional give N/W/S/E corners**                           |\n|                                                                       |\n| **- recommended for local analysis**                                  |\n|                                                                       |\n| **- ask for netcdf format**                                           |\n|                                                                       |\n| **\\\"\\\"\\\"**                                                            |\n|                                                                       |\n| **data = ct.catalogue.retrieve(**                                     |\n|                                                                       |\n| **\\'reanalysis-era5-single-levels\\',**                                |\n|                                                                       |\n| **{**                                                                 |\n|                                                                       |\n| **\\'variable\\': \\'2m_temperature\\',**                                 |\n|                                                                       |\n| **\\'grid\\': \\[\\'0.25\\', \\'0.25\\'\\],**                                 |\n|                                                                       |\n| **\\'product_type\\': \\'reanalysis\\',**                                 |\n|                                                                       |\n| **\\'year\\': \\[**                                                      |\n|                                                                       |\n| **\\'1981\\','1982','1983','1984','1985'**                              |\n|                                                                       |\n| **\\],**                                                               |\n|                                                                       |\n| **\\'month\\': \\[**                                                     |\n|                                                                       |\n| **\\'01\\', \\'02\\', \\'03\\', \\'04\\', \\'05\\', \\'06\\',\\'07\\', \\'08\\',      |\n| \\'09\\', \\'10\\', \\'11\\', \\'12\\',**                                     |\n|                                                                       |\n| **\\],**                                                               |\n|                                                                       |\n| **\\'day\\': \\[**                                                       |\n|                                                                       |\n| **\\'01\\', \\'02\\', \\'03\\', \\'04\\', \\'05\\', \\'06\\',\\'07\\', \\'08\\',      |\n| \\'09\\', \\'10\\', \\'11\\', \\'12\\',**                                     |\n|                                                                       |\n| **\\'13\\', \\'14\\', \\'15\\', \\'16\\', \\'17\\', \\'18\\',\\'19\\', \\'20\\',      |\n| \\'21\\', \\'22\\', \\'23\\', \\'24\\',**                                     |\n|                                                                       |\n| **\\'25\\', \\'26\\', \\'27\\', \\'28\\', \\'29\\', \\'30\\',\\'31\\'**             |\n|                                                                       |\n| **\\],**                                                               |\n|                                                                       |\n| **\\'time\\': \\[**                                                      |\n|                                                                       |\n| **\\'00:00\\',\\'01:00\\',\\'02:00\\',\\'03:00\\',\\'04:00\\',\\'05:00\\',**      |\n|                                                                       |\n| **\\'06:00\\',\\'07:00\\',\\'08:00\\',\\'09:00\\',\\'10:00\\',\\'11:00\\',**      |\n|                                                                       |\n| **\\'12:00\\',\\'13:00\\',\\'14:00\\',\\'15:00\\',\\'16:00\\',\\'17:00\\',**      |\n|                                                                       |\n| **\\'18:00\\',\\'19:00\\',\\'20:00\\',\\'21:00\\',\\'22:00\\',\\'23:00\\'**       |\n|                                                                       |\n| **\\],**                                                               |\n|                                                                       |\n| **\\'area\\': \\[\\'-1.5/30/-2.0/30.54\\'\\],**                             |\n|                                                                       |\n| **\\'format\\' : \\[\\'netcdf\\'\\]**                                       |\n|                                                                       |\n| **})**                                                                |\n|                                                                       |\n| **return data**                                                       |\n+-----------------------------------------------------------------------+\n\nThe second stage is to read the resulting data into R-Instat. For those\nwho were not online, the six files have also been renamed and copied\ninto the R-Instat library.\n\n***Go into R-Instat*** and use ***File \\> Open and Tidy NetCDF File***\nFig. 9.3i.\n\n  -------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.3i Loading the data for 1981-5***                                        ***Fig. 9.3j Six files in R-Instat***\n  ------------------------------------------------------ ------------------------------------------------------\n  ![](figures/Fig9.3i.png){width=\"2.9332370953630797in\"   ![](figures/Fig9.3j.png){width=\"3.1684503499562555in\"\n  height=\"2.824397419072616in\"}                          height=\"2.5948917322834646in\"}\n\n  -------------------------------------------------------------------------------------------------------------\n\nIn Fig. 9.3j, if you downloaded your own data, then choose ***Browse***,\notherwise choose ***From Library*** and ***use the file called\ncds.Rwanda_1981_5.nc***.\n\nThen recall the last dialogue and include the other five files, up to\ncds.Rwanda_2005_10. The resulting data are shown in Fig. 9.3k. There are\nabout 394,416 rows of data in each file (i.e. roughly 9 \\* 24 \\* 365 \\*\n5)\n\nThe next step is to append the files to give the 30-year record. Use\n***Climatic \\>Tidy and Examine \\> Append***, Fig. 9.3l. In Fig. 9.3k,\ninclude all 6 data frame, then the ID column isn't needed and the\nresulting data frame is named better than Append1.\n\n  -------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.3k Appending the 6 data frames***                                        ***Fig. 9.3l Temperatures into centigrade***\n  ------------------------------------------------------ ------------------------------------------------------\n  ![](figures/Fig9.3k.png){width=\"3.1482884951881016in\"   ![](figures/Fig9.3l.png){width=\"2.9195363079615047in\"\n  height=\"3.011654636920385in\"}                          height=\"2.777613735783027in\"}\n\n  -------------------------------------------------------------------------------------------------------------\n\nThe data column in Fig. 9.3k, called tas, is in degrees Kelvin. Use\n***Climatic \\> Prepare \\> Transform*** to change them into centigrade\nfor comparison with the station data, Fig. 9.3m.\n\nECMWF provides the time variable always in GMT (Greenwich Mean Time).\nRwanda is 2 hours ahead, so either, or both, the time variables in Fig.\n9.3k need to be moved forward by 2 hours. To make this change the data\nshould first be in \"station\" order. Hence first ***Right-Click*** and\nchoose ***Sort*** (or use Prepare \\> Data Frame \\> Sort) to produce the\ndialogue in Fig. 9.3m.\n\nNow use ***Prepare \\> Column: Calculate \\> Calculations*** as shown in\nFig. 9.3n. In the calculator the ***Transform*** keyboard includes the\n***lead*** function. The function, from the dplyr package is:\n\n***dplyr::lead(time_full,2)***, to move to Rwanda time. Pressing the\n***Try*** button in Fig. 9.3n shows the first value is now 2am GMT[^47].\n\n  -------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.3m***                                        ***Fig. 9.3n***\n  ------------------------------------------------------ ------------------------------------------------------\n  ![](figures/Fig9.3m.png){width=\"3.1482884951881016in\"   ![](figures/Fig9.3n.png){width=\"2.9195363079615047in\"\n  height=\"3.011654636920385in\"}                          height=\"2.777613735783027in\"}\n\n  -------------------------------------------------------------------------------------------------------------\n\nNow use ***Climatic \\> Dates \\> Make Date*** to make a new Date column\nfrom the Rwanda hourly column, Fig. 9.3o.\n\n  -------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.3o***                                        ***Fig. 9.3p***\n  ------------------------------------------------------ ------------------------------------------------------\n  ![](figures/Fig9.3o.png){width=\"2.9332370953630797in\"   ![](figures/Fig9.3p.png){width=\"3.1684503499562555in\"\n  height=\"2.824397419072616in\"}                          height=\"2.5948917322834646in\"}\n\n  -------------------------------------------------------------------------------------------------------------\n\nFinally generate Tmax and Tmin, on a daily basis, from the hourly\nvalues, ready to use, or to compare with station data. First\n***right-click*** and make the ***lon and lat columns into factors***.\nThe hourly data are now roughly as in Fig. 9.3p\n\nComplete the ***Prepare \\> Column: Reshape \\> Column Summaries***\ndialogue as shown in Fig. 9.3q. As these are temperatures the daily\nmaximum and minimum are calculated. The resulting worksheet, Fig. 9.3r,\nhas a more reasonable 100,000 rows of data at the 9 gridpoints.\n\n  -------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.3q***                                        ***Fig. 9.3r Resulting daily data***\n  ------------------------------------------------------ ------------------------------------------------------\n  ![](figures/Fig9.3q.png){width=\"3.1482884951881016in\"   ![](figures/Fig9.3r.png){width=\"2.9195363079615047in\"\n  height=\"3.011654636920385in\"}                          height=\"2.777613735783027in\"}\n\n  -------------------------------------------------------------------------------------------------------------\n\n## The IRI Data Store\n\nA third source of gridded data considered here is the IRI Data Library.\nIRI is the International Research Institute for Climate and Society\nbased in Colombia University, USA. The website for their data library is\n[[http://iridl.ldeo.columbia.edu/]{.underline}](http://iridl.ldeo.columbia.edu/)\n, Fig. 9.4a. The IRI Data Store is a large repository of climate data\nfrom a wide variety of sources. In many cases, the IRI Data Store is not\nthe only, or primary, source of the data, however the IRI Data Store\nprovides a simple consistent way of freely downloading from a large set\nof sources, and crucially allows for selecting sub-regions.\n\nAs well as downloading from the website, R-Instat includes a dialog to\ndirectly download and import some of the common data from the IRI Data\nStore. We demonstrate both methods here, using the R-Instat dialog to\ndownload CHIRPS daily rainfall estimates and the IRI Data Store website\nto download information on ENSO and sea surface temperatures.\n\n### Downloading directly from R-Instat\n\nClimate Hazards Group InfraRed Precipitation with Station data (CHIRPS),\nproduced by Climate Hazards Center UC Santa Barbara, USA, is a\nnear-global gridded rainfall data set, available from 1981 to\nnear-present with a spatial resolution of 0.05°. It is constructed by\ncombining satellite imagery and in-situ station data, and is available\non a daily, dekad and monthly basis. It's website is here\n[[https://www.chc.ucsb.edu/data/chirps]{.underline}](https://www.chc.ucsb.edu/data/chirps)\nbut the data is more easily available to download and subset from the\nIRI Data Store. It is an example of one of the datasets available to\ndownload directly from R-Instat.\n\nIn R-Instat go to ***Climatic \\> File \\> Import from IRI Data\nLibrary***, fig xxx. First select \"UCSB CHIRPS\" as the ***Source***. We\nwill download the daily data with the highest resolution available,\nhence choose \"Daily Precipitation 0.05 degree\" as the ***Data***, fig\nxxx. Source shows a limited set of data sources available in the IRI\nData Store which we think will be most commonly used by R-Instat users.\nIf there is a dataset from the IRI Data Store that you commonly use and\nthink we should add, please let us know and we can consider adding it to\nthe dialog.\n\nThe next two sections of the dialog allow for choosing a subset of time\nor location. By default, \"Entire Range\" is selected for the data range.\nFor CHIRPS, this means 1981 to near-present. We will use this option,\nbut if you want a shorter time period choose \"Custom Range\" and select\nthe \"From\" and \"To\" dates. The Location Range allows you to choose an\narea defined by longitude and latitude limits, or a single point, which\nwill extract the nearest grid point to the location you provide. Let's\nfirst choose a single point for Kigali, Rwanda at longitude 30.1 and\nlatitude -1.95, fig xxx.\n\nThe dialog will connect to the IRI Data Library and download the\nrequested data to your machine as a NetCDF file (.nc), a common format\nfor gridded data (CM SAF and C3S Climate Data Store data are also\nprovided in this format). Click ***Browse*** to choose where the\ndownload data will be saved to or accept the default of your Documents\nfolder. Choose an appropriate name for the new data frame. Now, click\n***Ok*** to download and import the data into R-Instat. It may take some\ntime for the request to be processed (up to 30 minutes), particularly\nfor requests that are for a long time period since data are usually\nstored in separate files for each time point. However, this does not\nmean the download will be a large file and the time can vary depending\non how busy the IRI Data Library servers are. While waiting, you will\nsee the R-Instat waiting dialog and the download progress bar. Do not\nworry if the progress bar does not move forward, this just means the\nrequest is still being processed. Once the request has been processed,\nthe download will usually be small and take very little time. For\nexample, this request should result in a download file of size \\~0.1MB.\n\nAfter finishing you will see the data imported into R-Instat, fig xxx.\nThe NetCDF file has been downloaded to the location chosen on the dialog\n(Documents by default) and the file has been imported into a data frame\nin R-Instat. The data frame has five columns. X and Y are the location\nand this should be constant since we requested a single point. Notice\nthat the value in Y is not exactly what we request. It is -1.97 and we\nrequest -1.95. This is because the closed grid point in the CHIRPS data\ngrid to the provided location is selected. .T is time as a number and\nT_date is a more useful column that is created by R-Instat when\nimporting as a Date column. prcp is precipitation. We can confirm this\nby looking at the column metadata: ***View \\> Column Metadata***. Scroll\nto the end to see the \"standard_name\" and \"units\" columns which confirm\nwhat each column represents and its units, fig xxx. Click ***View \\>\nColumn Metadata*** again to close the metadata. We can see that each row\nin the data represents a single day, starting on 1981-01-01. Use\n***Describe \\> One Variable \\> Summaries***, and select all columns to\nsee a summary of the data. The output is shown in fig xxx. We see that X\nand Y are constant, as expected. .T is numeric and not that useful, but\nT_date show the data ranges from 1981-01-01 to 2020-08-31 (as of October\n2020, usually 1 or 2 months behind the current date). prcp shows a\nsensible set of summaries for daily rainfall values. This is useful to\ndo to confirm that the request is as you expected. For example, if X and\nY are not constant but you wanted just a single point, then you may not\nhave done the request correctly.\n\nNotice that the data file is also stored on your machine in the folder\nyou chose. For example, in Documents my file is called\nucsb_chirps7f14482329.nc. If you need to import this data again, you can\nnow use the file directly, without requesting it again from the IRI Data\nStore. See section xxx on how to import NetCDF files.\n\nThis data is useful for comparison with a single station in Kigali. We\noften have data from multiple stations and would wish to extract gridded\ndata at each of the station locations. One way to do this would be to\nmake separate requests for each station location using the Import from\nIRI Data Library multiple times. However, this becomes time consuming\nfor many stations, particularly if the processing time is slow. Another\noption is to do a single request and download data for an area that\ncovers all the station locations and then afterwards extract the data\nfor the required locations.\n\nSo let's to this by download the same data for an area that covers\nRwanda instead of a single point. This will be a larger download file\n\\~280MB but should not take much longer to process. If you have an\ninternet connection able to download \\~300MB of data then try the next\nsteps below. If not, then this is just for reading.\n\nGo back to the ***Import from IRI Data Library*** dialog. The\n***Source***, ***Data*** and ***Date Range*** options remain the same.\nChange the ***Location Range*** option from \"Point\" to \"Area\" and enter\nthe values: longitude: min 28.5, max 30.5, latitude: min -2.5, max -1.4.\nThis area covers the four stations in Rwanda found in the R-Instat\nLibrary. Choose the location to save the download or use the same\nlocation. Now, the data request is for approximately a 2 degrees by 1\ndegree area, which will give approximately (2 / 0.05) x (1 / 0.05) = 40\nx 20 = 800 grid points, since the resolution is 0.05 degrees. We do not\nwant to directly import all 800 grid points into R-Instat as this would\nbe equivalent to 800 station records for 40 years. Instead, we want to\ndownload the data and then extract only a few grid points of interest\nafterwards. So we will check the option for \"Don't import data after\ndownloading\". This removes the new data frame name as it will not import\ninto R-Instat but will just download to your machine. Now click ***Ok***\nand it may take a similar amount of time to complete.\n\nAfter finishing you will not see any change in R-Instat but the file\nwill be downloaded to the chosen folder. We can now use the dialog at\n***Climatic \\> File \\> Import & Tidy NetCDF*** to import a subset of the\ngrid points based on station locations. This is shown in section xxx.\n\n### Download from the IRI Data Store\n\nAs examples, information on ENSO and sea surface temperatures are\naccessed. The maproom also contains instructional information, so typing\nENSO into the search, Fig. 9.4a, provides useful information, including\nthe areas of the Pacific ocean associated with the NINO situations, Fig.\n9.4b. Fig. 9.4b is accessed directly from\n[[https://iridl.ldeo.columbia.edu/maproom/ENSO/Diagnostics.html]{.underline}](https://iridl.ldeo.columbia.edu/maproom/ENSO/Diagnostics.html)\n\n  ------------------------------------------------------------------------------------------------------------\n  ***Fig.9.4a IRI Data Library***                        ***Fig. 9.4b NINO3.4***\n  ------------------------------------------------------ -----------------------------------------------------\n  ![](figures/Fig9.4a.png){width=\"3.8668733595800524in\"   ![](figures/Fig9.4b.png){width=\"2.130990813648294in\"\n  height=\"2.70544072615923in\"}                           height=\"2.7068285214348204in\"}\n\n  ------------------------------------------------------------------------------------------------------------\n\nIn Fig. 9.4a click on Data by Category, then on Climate Indices, Fig.\n9.4c and choose Indices nino EXTENDED, Fig. 9.4d.\n\n  -------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.4c***                                      ***Fig. 9.4d***  \n  ------------------------------------------------------ ------------------------------------------------------\n  ![](figures/Fig9.4c.png){width=\"2.6998807961504814in\"   ![](figures/Fig9.4d.png){width=\"3.4260433070866143in\"\n  height=\"2.4705489938757657in\"}                         height=\"2.2284437882764654in\"}\n\n  -------------------------------------------------------------------------------------------------------------\n\nChoose ***nino34***, in Fig. 9.4e and then go straight to ***data\nfiles***. The next screen shows a variety of output formats, including\nNetCDF, which you choose.\n\n  -----------------------------------------------------------------------------------------------------------\n  ***Fig. 9.4e***                                       ***Fig. 9.4f***\n  ----------------------------------------------------- -----------------------------------------------------\n  ![](figures/Fig9.4e.png){width=\"3.075055774278215in\"   ![](figures/Fig9.4f.png){width=\"2.899403980752406in\"\n  height=\"3.0795778652668417in\"}                        height=\"3.59878280839895in\"}\n\n  -----------------------------------------------------------------------------------------------------------\n\nNow, in R-Instat, use File \\> Open and Tidy NetCDF File. If you followed\nthe screens above, then browse for the file that was downloaded.\nOtherwise there is a copy in the R-Instat library to March 2019, Fig.\n9.4g.\n\n  ------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.4g***                                       ***Fig. 9.4h***\n  ----------------------------------------------------- ------------------------------------------------------\n  ![](figures/Fig9.4g.png){width=\"2.841988188976378in\"   ![](figures/Fig9.4h.png){width=\"2.6477077865266843in\"\n  height=\"2.867364391951006in\"}                         height=\"3.06124343832021in\"}\n\n  ------------------------------------------------------------------------------------------------------------\n\nThe data are now imported into R-Instat, Fig. 9.4h. The time variable\nhas not been recognised as a date. You may wish to click on the I (for\ninformation -- the metadata) and this will confirm that the column,\ncalled T, is months since January 1960. If the fact that some values\nappear the same in this column, then change the number of significant\nfigures in that column, from 3 to 5.\n\nThe first value of T, in Fig. 9.4h is -1248. Dividing by 12 gives 104\nyears, so the data start in January 1856!\n\nUse Climatic \\> Dates \\> Generate Dates, Fig. 9.4i. In Fig. 9.4i, change\nthe starting date to January 1856, the end date to March 2019 (if using\nthe library dataset), and the step to 1 Month. The resulting date column\nis shown in Fig. 9.4j.\n\n  ------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.4i***                                       ***Fig. 9.4j***\n  ----------------------------------------------------- ------------------------------------------------------\n  ![](figures/Fig9.4i.png){width=\"2.841988188976378in\"   ![](figures/Fig9.4j.png){width=\"2.6477077865266843in\"\n  height=\"2.867364391951006in\"}                         height=\"3.06124343832021in\"}\n\n  ------------------------------------------------------------------------------------------------------------\n\nCountries have their own definition of when the NINO3.4 implies a year,\nor season is El Niño, or La Niña, see\n[[https://en.wikipedia.org/wiki/El_Ni%C3%B1o]{.underline}](https://en.wikipedia.org/wiki/El_Ni%C3%B1o),\nsome use the NINO3.4 value and others use NINo3, or even NINO1 and 2.\nThe site\n[[http://www.bom.gov.au/climate/enso/enlist/index.shtml]{.underline}](http://www.bom.gov.au/climate/enso/enlist/index.shtml)\ngives a detailed description of El Niño events since 1900, Fig. 9.4k,\nwith a companion page for La Niña.\n\n  ------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.4k***                                       ***Fig. 9.4l***\n  ----------------------------------------------------- ------------------------------------------------------\n  ![](figures/Fig9.4k.png){width=\"3.470980971128609in\"   ![](figures/Fig9.4l.png){width=\"2.5918022747156604in\"\n  height=\"2.1808070866141733in\"}                        height=\"1.7213331146106736in\"}\n\n  ------------------------------------------------------------------------------------------------------------\n\nThe SSTs themselves are often used for seasonal forecasting. This is\nillustrated with the SSTs for the Nino3.4 region.\n\n***Return to the main page***, Fig. 9.4a, then choose ***Data by\nCategory*** again, but this time, in Fig. 9.4c, choose ***Air-Sea\nInterface***. In the resulting screen, choose the ***NOAA NCDC ERSST\nversion5***, Fig. 9.4l.\n\nIn the resulting screen, Fig. 9.4m, choose ***anomalies*** and then\n***Data Selection***.\n\n  ------------------------------------------------------------------------------------------------------------\n  ***Fig. 9.4m***                                       ***Fig. 9.4n***\n  ----------------------------------------------------- ------------------------------------------------------\n  ![](figures/Fig9.4m.png){width=\"2.991107830271216in\"   ![](figures/Fig9.4n.png){width=\"3.0622233158355208in\"\n  height=\"2.34369750656168in\"}                          height=\"2.5905457130358704in\"}\n\n  ------------------------------------------------------------------------------------------------------------\n\nSet the ***time, attitude and longitude*** as shown in Fig. 9.4n and\nthen ***Restrict Ranges***. The part at the top of Fig. 9.4n should\nchange accordingly and you now press ***Stop Selecting***.\n\nFig. 9.4m now has the three ranges added, in blue, Fig. 9.4o. Click on\nData Files to give the same as Fig. 9.4f, earlier. Choose the NetCDF\noption again to download the file.\n\n  -----------------------------------------------------------------------------------------------------------\n  ***Fig. 9.4o***                                       ***Fig. 9.4p***\n  ----------------------------------------------------- -----------------------------------------------------\n  ![](figures/Fig9.4o.png){width=\"2.780994094488189in\"   ![](figures/Fig9.4p.png){width=\"3.290544619422572in\"\n  height=\"1.8450831146106736in\"}                        height=\"2.7998042432195978in\"}\n\n  -----------------------------------------------------------------------------------------------------------\n\nUse the File \\> Input and Tidy NetCDF File as in Fig. 9.4g. Then use the\nClimatic \\> Dates \\> Generate Dates dialogue as shown in Fig. 9.4p. In\nFig. 9.4p, remember to change to the new data frame. Then set the\nstarting date to January 1921 and there are now 130 values (26 E-W, by 5\nN-S) at each time point.\n\nIn Fig. 9.4p, if all is correct, the generated sequence should match the\nlength of the data frame. Once accepted, the resulting data frame is\nshown in Fig. 9.4q. Here each pixel is a 2 degree square, so the first\nrow is the temperature anomaly round 120°W and 4°S for January 1921.\n\n  -----------------------------------------------------------------------\n  ***Fig. 9.4q***\n  -----------------------------------------------------------------------\n  ![](figures/Fig9.4q.png){width=\"2.993989501312336in\"\n  height=\"3.175609142607174in\"}\n\n  -----------------------------------------------------------------------\n\n## Using the CM SAF toolbox for NetCDF files\n\nThe CM SAF toolbox is an R software package designed to process the\nNetCDF files downloaded from EUMETSAT, Section 9.3. It is used on the\ndownloaded files from EUMETSAT (or from other organisations who have\nNetCDF files). This may be all you need, if your interest is in some\nproducts from the EUMETSAT data. Or it may be before using R-Instat if\nyour interest is in comparing station and satellite data.\n\n## Defining ENSO\n\nSee\n[[https://www.ncdc.noaa.gov/teleconnections/enso/indicators/sst/]{.underline}](https://www.ncdc.noaa.gov/teleconnections/enso/indicators/sst/)\n\n[Warm and cold phases are defined as a minimum of five consecutive\n3-month running mean of SST anomalies\n([[ERSST.v5]{.underline}](http://origin.cpc.ncep.noaa.gov/products/analysis_monitoring/ensostuff/ONI_v5.php))\nin the Niño 3.4 region surpassing a threshold of +/- 0.5°C]{.mark}","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"Chapter_9_Gridded_Data.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.45","bibliography":["references.bib"],"theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"Chapter_9_Gridded_Data.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}