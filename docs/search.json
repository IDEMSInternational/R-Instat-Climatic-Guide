[
  {
    "objectID": "Chapter_2_More_Practice_with_RInstat.html",
    "href": "Chapter_2_More_Practice_with_RInstat.html",
    "title": "3  More Practice with R-Instat",
    "section": "",
    "text": "3.1 Introduction\nTo use climatic data fully it is important to be able to deliver products. The two examples in this chapter describe the steps and the endpoint in this process. Data are supplied in the right form for the analysis. The objectives are specified, and your task is to prepare the tables and graphs for a report and a presentation.\nSome familiarity with R-Instat is assumed. There are two initial tutorials and following those is enough preparation. If you have already used a statistics package before, then the examples below may be sufficient for you, even without the tutorials. This chapter is also designed to provide practice with R-Instat.\nThe first problem builds on a study in Southern Zambia. This is the most drought-prone area of the country. Everyone knew that there is 'climate change'! Some farmers were emigrating North, citing climate change as their reason. However, a local non-governmental organization (NGO) called the Conservation Farming Unit, questioned this reasoning for the rainfall data. They are not convinced that any climate change has necessarily affected the farming practices. They, therefore, commissioned a study that used daily climatic data from several stations in Southern Zambia. The results were supplied as a report, and presentations of the results were also made to the NGO and to the local FAO Officers. The results confirmed evidence of climate change in the temperature data, but not in the rainfall. The key conclusions were later made into short plays that were broadcast on local radio and played at village meetings.\nHere we use data from Moorings, a site in Southern Zambia. The daily data, on rainfall, are from 1922 to 2009. Here, partly for simplicity, we largely use the monthly summaries.\nFor the work, we draw an analogy with the preparation of a meal. The first key requirement is that you have the food, which here is the climatic data. In a real meal, the food may be supplied in a form that is ready for cooking, or it may need preparation prior to cooking. Here the data are in pre-packed form, so the analysis can proceed quickly.\nYou also need the right tools. In a kitchen, they are the saucepans, etc, while here they are just the computer, together with the required software.\nYou need some general cooking skills. These are the basic computing skills, plus initial skills of R-Instat, at least from the tutorial.\nFinally, your objectives must be clear. This corresponds to having a specific meal in mind so that a recipe can be used. Of course, you may have to adapt slightly as you go along. You might find some oddities in the data, just as cooks must improvise if they suddenly find that one of the ingredients is not available.\nIf everything is well organized, the cook can prepare the meal very quickly. This is just what is done in the products in this chapter. This leaves time to make sure the dishes, for us the results, are presented attractively. Then users will enjoy consuming what is presented.\nSection 2.2 describes the data for this first task. Trends in the rainfall are examined in Section 2.3. A second problem, in Section 2.4, examines whether satellite data on sunshine hours resembles corresponding station data. Daily data from Dodoma, Tanzania, are used.\nThe data for each of these case studies are in the R-Instat library. The presentation is designed so users can repeat the analyses on their laptops.\nGraphs are produced in each of these sections and the general methods for graphics in R-Instat is outlined in Section 2.5. Section 3.5 then adds a warning. R-Instat provides an easy-to-use click and point way of using the R programming language. It should help users to solve may problems. But a click-and-point system is not the right tool for all problems. We describe a problem that may require more programming skills, at least if you wish to prevent your computer from laughing at you!\nThis chapter demonstrates R-Instat as a simple general statistics package and the File, Prepare and Describe menus are used. It illustrates that a general statistics package is an appropriate tool for many climatic problems. It is also designed to consolidate your experience in using R-Instat. The special climatic menu is introduced in chapter 4.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>More Practice with R-Instat</span>"
    ]
  },
  {
    "objectID": "Chapter_2_More_Practice_with_RInstat.html#the-moorings-data",
    "href": "Chapter_2_More_Practice_with_RInstat.html#the-moorings-data",
    "title": "3  More Practice with R-Instat",
    "section": "3.2 The Moorings data",
    "text": "3.2 The Moorings data\nMonthly data are used in this part of the chapter. Daily data are the starting point in most of this guide because many of the objectives require daily data. But here the emphasis is on objectives for which the monthly data are suitable.\nThe data are already in an R-Instat file. Hence, they can be opened from the library in R-Instat library.\nFrom the opening screen in R-Instat, select File &gt; Open From Library as shown in Fig. 2.2a. Choose Load From Instat Collection, Then Browse to the Climatic directory then to Zambia. Select the file called Moorings_July.rds to give the screen shown in Fig. 2.2b. Press Ok.\n\n\n\n\n\n\n\nFig. 2.2a File &gt; Open from Library\nFig. 2.2b Ready to import Moorings.RDS\n\n\n\n\nClimatic &gt; Zambia &gt; Moorings.RDS\n\n\n\n\n\n\n\n\nThe resulting data are shown in Fig. 2.2c. There are 2 data frames. The one called Moorings has daily data.\nMove to the second data frame as shown in Fig. 2.2c which shows the monthly totals. They are the total rainfall in mm and the total number of rain days. A rain day was defined as a day with more than 0.85mm[^1].\n\n\n\n\n\n\n\nFig. 2.2c The Moorings monthly data\nFig. 2.2d Boxplot dialogue on the Describe menu\n\n\n\n\n\nDescribe &gt; Specific &gt; Boxplot\n\n\n\n\n\n\n\nRainfall in Southern Zambia is from November to April. Hence, we analyze the data by season, rather than by year. There are 88 seasons from 1922 to 2009 and 1056 monthly values, as indicated in Fig. 2.2c.\nThe task is to write a short report that describes the patterns of rainfall. One aim is to assess whether there is obvious evidence of change in the pattern of rainfall. This evidence might justify requesting the data from multiple stations, to undertake a more detailed study. The first step is to explore the data, and then consider how appropriate results could be presented. To explore we start with a boxplot to show the seasonal pattern of the rainfall totals.\nChoose the Boxplot dialogue from the Describe menu, with Describe &gt; Specific &gt; Boxplot, as shown in Fog. 2.2d. Complete the dialogue as shown in Fig. 2.2e. The resulting graph is shown in Fig. 2.2f[^2]. This shows the total rainfall was typically 200mm in each of December to February. There was always some rain in each of these months, and the records were over 500mm.\n\n\n\n\n\n\n\nFig. 2.2e Completed boxplot dialogue\nFig. 2.2f Boxplot of monthly rainfall totals\n\n\n\n\nDescribe &gt; Specific &gt; Boxplot\n\n\n\n\n\n\n\n\nChange the variable from rain to raindays in Fig. 2.2e to give the corresponding boxplots for the number of raindays in the month, Fig. 2.2g. This shows that typically one day in two are rainy in December to February. Occasionally most of the days are rainy.\nBoxplots are essentially a 5-number summary of the data, (with potential outliers also shown). The Prepare &gt; Column: Reshape &gt; Column Summaries, Fig. 2.2h, dialogue can provide the same summaries numerically.\n\n\n\n\n\n\n\nFig. 2.2g The number of rain days\nFig. 2.2h Summary dialogue on the Prepare menu\n\n\n\n\n\n\n\n\n\nSummarise both the monthly totals and the number of raindays, with the month as the factor, as shown in Fig. 2.2i. Then choose the Summaries button and complete the sub-dialogue as shown in Fig. 2.2j.\n\n\n\n\n\n\n\nFig. 2.2i Summary dialogue\nFig. 2.2j Summaries sub-dialogue\n\n\n\n\nPrepare &gt; Column: Reshape &gt; Column Summaries\n\n\n\n\n\n\n\n\nThe results are in a third data frame. It just has 12 rows as shown in Fig. 2.2k. The summaries are clearer if they are in order (which we did already for Fig. 2.2k).\nRight-click in the name field of this data frame and choose the option to Reorder columns, Fig. 2.2l.\n\n\n\n\n\n\n\nFig. 2.2k Resulting summary data\nFig. 2.2l Right-click menu to reorder columns\n\n\n\n\n\n\n\n\n\nIn the Reorder dialogue, use the arrow keys to change the position of the columns in the data frame.\nWith the summaries in a sensible order, they are now transferred to the results (output) window.\n\n\n\n\n\n\n\nFig. 2.2m Reorder the resulting columns\nFig. 2.2n Simplify column names\n\n\n\n\nRight-click &gt; Reorder column(s)\nRight-click &gt; Rename column(s)\n\n\n\n\n\n\n\nBefore this, we renamed some of the columns to give shorter names. This again used the right-click menu, Fig 2.2l. The rename dialogue is shown in Fig. 2.2n.\n\n\n\n\n\n\n\nFig. 2.2o View Data dialogue\nFig. 2.2p The Monthly number of rain days\n\n\n\n\nPrepare &gt; Data Frame &gt; View Data\n\n\n\n\n\n\n\n\nNow use the Prepare &gt; Data Frame &gt; View Data dialogue, Fig. 2.2o, to transfer the rainfall totals and then the number of rain days to the results window. The results for the number of rain days are shown in Fig. 2.2p.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>More Practice with R-Instat</span>"
    ]
  },
  {
    "objectID": "Chapter_2_More_Practice_with_RInstat.html#the-objectives",
    "href": "Chapter_2_More_Practice_with_RInstat.html#the-objectives",
    "title": "3  More Practice with R-Instat",
    "section": "3.3 The objectives",
    "text": "3.3 The objectives\nSection 2.2 explored the data and examined the seasonal pattern of the rainfall at Moorings. It also made use of the three menus, File, Prepare and Describe and well as the right-click menu. The main objective, however, was to see if there is evidence of rainfall change rather than to investigate the seasonal pattern.\nWe first examine the annual totals and the total number of rain days. These are the totals from July to June, so they cover each season.\nSome “housekeeping” is a preliminary. The 3rd data-frame is no longer needed. Right-click on the bottom tab a and choose the option to delete, Fig. 2.3a. The dialogue shown in Fig. 2.3b opens. Just press ok.\n\n\n\n\n\n\n\nFig. 2.3a Right-click on the bottom tab\nFig. 2.3b Delete a data frame\n\n\n\n\n\n\n\n\n\nUse Prepare &gt; Column: Reshape &gt; Column Summaries and complete the dialogue and sub-dialogue as shown in Fig. 2.3c and Fig. 2.3d to produce the seasonal totals.\n\n\n\n\n\n\n\nFig. 2.3c Produce the annual totals\nFig. 2.3d The Summaries sub-dialogue\n\n\n\n\nPrepare &gt; Column: Reshape &gt; Column Summaries\n\n\n\n\n\n\n\n\nThe results are shown in Fig. 2.3 e after the steps explained below. First, notice in Fig. 2.3e that there were only 4 months in the first season, and the annual summary was therefore set to missing[^3].\n\n\n\n\n\n\n\nFig. 2.3e Resulting annual data\nFig. 2.3f Menu for a text substring\n\n\n\n\n\n\n\n\n\nA numeric column for the year (season) is needed for the time series graphs. Hence, as shown below, we produce the second column, called s_yr, also shown in Fig. 2.3e.\nUse Prepare &gt; Column: Text &gt; Transform, Fig. 2.3f. Complete the resulting dialogue, as shown in Fig. 2.3g, to give just the starting year of the season. The resulting variable is shown in Fig. 2.3e.\n\n\n\n\n\n\n\nFig. 2.3g The Substring Option\nFig. 2.3h Convert Column to Numeric\n\n\n\n\nPrepare &gt; Column: Text &gt; Transform\n\n\n\n\n\n\n\n\nUse the right-click menu, Fig. 2.3h to convert the resulting s_yr column to numeric.\nAfter a little further housekeeping from the right-click menu, to rename, re-order and delete columns, the annual data are as shown in Fig. 2.3e above.\nNow for the time-series graphs. They can be produced using the Describe &gt; Specific &gt; Line Plot dialogue, but this type of graph is just what is needed for the PICSA-style rainfall graphs, so we use the special climatic menu for the first time.\nUse Climatic &gt; PICSA &gt; Rainfall Graph. Complete as shown in Fig. 2.3i. Press the PICSA Options button and complete the Lines ab as shown in Fig. 2.3j to add (and label) a horizontal line for the mean.\n\n\n\n\n\n\n\nFig. 2.3i PICSA Rainfall graph dialogue\nFig. 2.3j Add a line showing the mean\n\n\n\n\nCLimatic &gt; PICSA &gt; Rainfall Graph\n\n\n\n\n\n\n\n\nThe resulting graph is shown in Fig 2.3k[^4]. Return to the dialogue and put raindays as the y-variable to give the results in Fig. 2.3l.\n\n\n\n\n\n\n\nFig. 2.3k Seasonal rainfall totals\nFig. 2.3l Number of rain days\n\n\n\n\n\n\n\n\n\nThese graphs indicate large inter-annual variability, but they don’t seem to show a trend. That is important because, if you can attribute your farming problems to climate change, then there may be nothing you can do. But coping with the variability is what farmers have always had to do.\nWith results such as shown in Fig. 2.3k and 2.3l you can start comparing risks for different options in your farming and in other enterprises. That sort of idea is discussed in PICSA workshops.\nSome may find the graph shown above to be convincing evidence that, with rainfall, the pressing problem is variability, rather than change. We stress that there IS climate change, and similar graphs with temperature data show a trend. If the temperatures have changed, then the “system” has changed, and it follows that other elements including rainfall will be affected. Currently, however, with this sort of analysis, it is usually not yet possible to determine which way the pattern of rainfall may change. It is difficult to detect a small change when the inter-annual variability is so large. And, even if a change is detected, coping as well as possible with the variability must be a good thing to do.\nSome people are not convinced by graphs such as are shown above. A common statement is that the annual totals that might still be similar, but the season is shorter, because planting is delayed, etc. We examine this in more detail in Chapter 7. There the daily data are used to define the start, end and length of the season as well as to examine dry spells and extremes during the season. With the monthly total, the examination can start by repeating the analysis above, but just for November and December, when the season starts.\nReturn to the monthly data frame and filter to examine just those months. So, make sure you are on the monthly data. Right click as usual and choose Filter, Fig. 2.3m\n\n\n\n\n\n\n\nFig. 2.3m Right-click for Filter\nFig. 2.3n The filter dialogue\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFig. 2.3m Right-click for Filter\nFig. 2.3n The filter dialogue\n\n\n\n\n\n\n\n\n\nIn Fig. 2.3n, click to Define new Filter. Complete the sub-dialogue as shown in Fig. 2.3o. The steps are as follows:\n\nChoose the month column\nSelect Nov and Dec as shown in Fig. 2.3p\nClick to Add Condition\nPress Return\n\n\n\n\n\n\n\n\nFig. 2.3o Define the filter\nFig. 2.3p The filtered data\n\n\n\n\nPrepare &gt; Column: Reshape &gt; Column Summaries\n\n\n\n\n\n\n\n\nBack on the main filter dialogue, just press Ok. The data are now as shown in Fig. 2.3p. The first column is in red and this shows a filter is in operation. Also, at the bottom of the data frame, you see there are now 176 rows (months) of data to analyse, out of the original 1062 rows.\nThe other data have not gone away. If ever you wish to return, then just press right-click as before, Fig. 2.3m and choose the last option to Remove Current Filter.\nNow it is quick to repeat the steps above for this analysis. It is simpler to recall the last dialogues as shown in Fig. 2.3q.\n\n\n\n\n\n\n\nFig. 2.3q Recall the last dialogues\nFig. 2.3r The Column Statistics dialogue\n\n\n\n\n\n\n\n\n\nThe Column Statistics dialogue and sub-dialogue remain completed from before, Fig. 2.3r. So just press Ok.\nThe new columns have added to the existing annual sheet. So, go straight to the PICSA Rainfall Graphs dialogue again. Choose the new variable for the November-December totals and press OK. The mean is now 286mm for the 2 months. Repeat for the number of rain days to give the graphs for the filtered data, see Fig. 2.3s and 2.3t.\n\n\n\n\n\n\n\nFig. 2.3s Rainfall totals Nov-Dec\nFig. 2.3t Number of rain days Nov-Dec\n\n\n\n\n\n\n\n\n\nOne feature of the data in Fig. 2.3s is that had the record started in 1981, then it might have given an impression of an upward trend in the rainfall total. The longer record shows that this sort of conclusion should be treated with considerable caution!\nThese graphs start to satisfy the objective of examining the rainfall data in Southern Zambia for trends. The results should be considered as provisional if only because they are from just a single station and only use the monthly data. We suggest they make a case for a more complete analysis with multiple stations.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>More Practice with R-Instat</span>"
    ]
  },
  {
    "objectID": "Chapter_2_More_Practice_with_RInstat.html#comparing-satellite-and-station-data",
    "href": "Chapter_2_More_Practice_with_RInstat.html#comparing-satellite-and-station-data",
    "title": "3  More Practice with R-Instat",
    "section": "3.4 Comparing satellite and station data",
    "text": "3.4 Comparing satellite and station data\nOur proposed objective is to report on the feasibility of using satellite estimates of sunshine hours to supplement the information from station data. The station network for sunshine or radiation is sparse in many countries. Where it exists the records often have many missing values.\nEstimates of daily hours of sunshine are also available from the EUMETSAT CMSAF (Climate Monitoring Satellite Application Facility) for about 5km square pixels. The data are available from 1983 and may be downloaded free of charge. These data are in NetCDF files and examples from a few locations have been downloaded and are the R-Instat library.\nData from Dodoma, Tanzania was analysed in the second tutorial and the same dataset is used here. In this exercise, these data are merged with the corresponding satellite data and the two variables are then compared.\nAs in the tutorial use File &gt; Open From Library. Choose the Instat collection. Browse to the Climatic directory and choose the Original Climatic Guide datasets. Choose just the Dodoma sheet, Fig. 2.4a.\n\n\n\n\n\n\n\nFig. 2.4a Importing the Dodoma data\nFig. 2.4b The Summaries sub-dialogue\n\n\n\n\n\n\n\n\n\nOnce imported use Prepare &gt; Column: Date &gt; Make Date, Fig. 2.4b to construct a date column from the Year, Month, Day columns. Name the resulting column as Date, see Fig. 2.4b.\nNow use File &gt; Import and Tidy NetCDF File, Fig. 2.4c. Choose the option From Library and the file that starts CMSAF_SDU (for sunshine duration). This file contains just the data from the nearest pixel to the Dodoma station data.\n\n\n\n\n\n\n\nFig. 2.4c Import the CMSAF Satellite data\nFig. 2.4d Change the name to Date\n\n\n\n\n\n\n\n\n\nOnce imported, right-click to change the name of the last column from time_date to Date, i.e. to the same name as in the station data, Fig. 2.4d[^5].\n\n\n\n\n\n\n\nFig. 2.4e The Merge dialogue\nFig. 2.4f Sub-dialogue to add just SDU\n\n\n\n\n\n\n\n\n\nUse Prepare &gt; Column: Reshape &gt; Merge and complete the dialogue as shown in Fig. 2.4e. It chooses to match on the Date columns, which is what we want. That is why we gave them the same name in the two data frames[^6].\nThe SDU column is all we need from the satellite data. So, press the Merge Options button in Fig. 2.4e. Use the Columns to Include tab and complete as shown in Fig. 2.4f. Press Return and then Ok.\nNow check, using Describe &gt; One Variable &gt; Summarise on the merged data. Choose all the columns and press Ok. The results are in Fig. 2.4g.\n\n\n\n\n\n\n\nFig. 2.4g Results from One Variable Summarise\nFig. 2.4h Generate columns from the Date\n\n\n\n\nDescribe &gt; One Variable &gt; Summarise\nPrepare &gt; Column: Date &gt; Make Date\n\n\n\n\n\n\n\nAn encouraging sign in Fig. 2.4g is that summary statistics for the Sunh (from the station) and SDU (from the satellite) are almost identical. The maximum of 16 hours for SDU is a little concerning, because that is probably longer than the maximum day length at Dodoma.\nSome “housekeeping” is useful, because the results in Fig. 2.4g also show there are some missing values in the year and day of month column[^7].\nRight-click and delete the first 3 columns. Then generate them again (without missing values) using Prepare &gt; Column: Date &gt; Use Date dialogue, Fig. 2.4h. Then use Describe &gt; One Variable &gt; Summarise again to confirm the new columns do not have missing values.\n\n\n\n\n\n\n\nFig. 2.4i Resulting merged data\nFig. 2.4j Correlations dialogue\n\n\n\n\n\n\n\n\n\nRight-Click and choose Reorder Column(s). The resulting data should be like that shown in Fig. 2.4i.\nWe are now ready to compare the satellite data (SDU) with the station values (sunh).\n\n\n\n\n\n\n\nFig. 2.4k Correlations sub-dialogue\nFig. 2.4l Results\n\n\n\n\n\n\n\n\n\nUse Describe &gt; Multivariate &gt; Correlations. and enter SDU and sunh, Fig. 2.4j. Click on Options and choose Scatter Matrix. Fig. 2.4k. The results are in Fig. 2.4l.\nThe results in Fig. 2.4l look promising. The shape of the satellite (bottom right) and station data (top left) look similar and the correlation is a reasonably satisfactory 0.87.\nWhat is next? These data (both sunh and SDU) are time series. Time series have seasonality, and this should usually be reflected in the analysis.\nSo, return to the correlations dialogue and sub-dialogue, Fig. 2.4k and add the month factor.\n\n\n\n\n\n\n\nFig. 2.4m Including months in the analysis\nFig. 2.4n The Histogram dialogue\n\n\n\n\n\n\n\n\n\nThe results in Fig. 2.4m show that the shape of both variables depends on the month. In particular (as expected) there is often less sun in the rainy season (November to April) and the correlations are then higher. The display, in Fig. 2.4m, is also confusing as there are now too many groups to see clearly what is happening.\nIt is time to split up the components of the results in Fig. 2.4m to compare the satellite and station data in more detail.\nUse Describe &gt; Specific &gt; Histogram, Fig. 2.4n.\n\n\n\n\n\n\n\nFig. 2.4o A set of density graphs\nFig. 2.4p Include facets in the graph\n\n\n\n\n\n\n\n\n\nChange the button at the top of Fig. 2.4o to Density and click on Plot Options.\nIn the sub-dialogue, Fig. 2.4p tick the checkbox to include facets and include the month factor.\n\n\n\n\n\n\n\nFig. 2.4q Multiple variables\nFig. 2.4r Resulting graphs\n\n\n\n\nDescribe &gt; One Variable &gt; Summarise\nPrepare &gt; Column: Date &gt; Make Date\n\n\n\n\n\n\n\nReturn to the main dialogue, and click to include multiple variables, Fig. 2.4q. Include Sunh and SDU and press Ok. The graphs from Fig. 2.4m are now overlaid, so they can easily be compared, and displayed separately for each month. Fig. 2.4r shows the pattern is similar in each month. We also see the sharp peaks in the dry months, particularly from June to October, when most days have about 10 hours of sunshine per day.\nFig. 2.4r shows the pattern of sunshine is similar from the satellite and station data. It does not, however, show whether a day in any month with more sunshine at the station (sunh), also had more sunshine from the satellite data (SDU). For this, we look at the scatterplot from Fig. 2.4m again broken into the monthly facets.\nUse Describe &gt; Specific &gt; Scatterplot and complete the dialogue as shown in Fig. 2.4s. Press on Plot Options and include the months as facets, Fig. 2.4t, just as earlier in Fig. 2.4p.\n\n\n\n\n\n\n\nFig. 2.4s Scatterplot dialogue\nFig. 2.4t Plotting sub-dialogue\n\n\n\n\n\n\n\n\n\nThe resulting set of graphs is shown in Fig. 2.4u.\n\n\n\n\n\n\nFig. 2.4u Scatterplots for each month\n\n\n\n\n\n\n\n\nOur initial objective was to examine whether the satellite estimates may be useful in Tanzania to supplement the station data. The results are promising, but this just the start. There are many possible next steps, including an examination of the occasions when the two variables differ substantially. The analysis should also be extended to multiple stations. We also need more numerical summaries to measure how close the two variables are. Chapter 10 considers this subject in more detail.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>More Practice with R-Instat</span>"
    ]
  },
  {
    "objectID": "Chapter_2_More_Practice_with_RInstat.html#in-conclusion",
    "href": "Chapter_2_More_Practice_with_RInstat.html#in-conclusion",
    "title": "3  More Practice with R-Instat",
    "section": "3.5 In conclusion",
    "text": "3.5 In conclusion\nTo be added",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>More Practice with R-Instat</span>"
    ]
  }
]