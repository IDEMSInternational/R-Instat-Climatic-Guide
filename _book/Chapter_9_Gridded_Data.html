<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.45">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Gridded Data – R-Instat Climatic Guide</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter_10_Comparing_Data_from_Different_Sources.html" rel="next">
<link href="./Chapter_8_Efficient_use_of_RInstat_and_R.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter_9_Gridded_Data.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Gridded Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R-Instat Climatic Guide</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Acknowledgments</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_1_About_this_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">About this guide</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_2_More_Practice_with_RInstat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">More Practice with R-Instat</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_3_Using_RInstat_effectively.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Using R-Instat effectively</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_4_Getting_the_data_into_shape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Getting the data into shape</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_5_Quantity_and_quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Quantity and quality?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_6_Preparing_summaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Preparing summaries</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_7_Tailored_Products.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Tailored Products</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_8_Efficient_use_of_RInstat_and_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Efficient use of R-Instat and R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_9_Gridded_Data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Gridded Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_10_Comparing_Data_from_Different_Sources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Comparing Data from Different Sources</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_11_Drawing_Maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Drawing Maps</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_12_Extremes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Extremes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_13_PICSA__Long_Before_the_season.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">PICSA – Long Before the season</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_14_The_Seasonal_forecast.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The Seasonal forecast</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_15_Fitting_and_using_stochastic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Fitting and using stochastic models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_16_Withinday_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Within-day data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_17_Circular_data_and_wind_roses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Circular data and wind roses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_18_Temperatures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Temperatures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_19_Drought_Indices__SPI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Drought Indices – SPI</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_20_Climate_Normals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Climate Normals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_21_Various.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Various</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_22_References.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_23_Appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Appendix</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">10.1</span> Introduction</a></li>
  <li><a href="#importing-netcdf-files" id="toc-importing-netcdf-files" class="nav-link" data-scroll-target="#importing-netcdf-files"><span class="header-section-number">10.2</span> Importing NetCDF files</a></li>
  <li><a href="#eumetsat-cm-saf" id="toc-eumetsat-cm-saf" class="nav-link" data-scroll-target="#eumetsat-cm-saf"><span class="header-section-number">10.3</span> EUMETSAT CM SAF</a></li>
  <li><a href="#c3s-climate-data-store" id="toc-c3s-climate-data-store" class="nav-link" data-scroll-target="#c3s-climate-data-store"><span class="header-section-number">10.4</span> C3S Climate Data Store</a></li>
  <li><a href="#the-iri-data-store" id="toc-the-iri-data-store" class="nav-link" data-scroll-target="#the-iri-data-store"><span class="header-section-number">10.5</span> The IRI Data Store</a>
  <ul class="collapse">
  <li><a href="#downloading-directly-from-r-instat" id="toc-downloading-directly-from-r-instat" class="nav-link" data-scroll-target="#downloading-directly-from-r-instat"><span class="header-section-number">10.5.1</span> Downloading directly from R-Instat</a></li>
  <li><a href="#download-from-the-iri-data-store" id="toc-download-from-the-iri-data-store" class="nav-link" data-scroll-target="#download-from-the-iri-data-store"><span class="header-section-number">10.5.2</span> Download from the IRI Data Store</a></li>
  </ul></li>
  <li><a href="#using-the-cm-saf-toolbox-for-netcdf-files" id="toc-using-the-cm-saf-toolbox-for-netcdf-files" class="nav-link" data-scroll-target="#using-the-cm-saf-toolbox-for-netcdf-files"><span class="header-section-number">10.6</span> Using the CM SAF toolbox for NetCDF files</a></li>
  <li><a href="#defining-enso" id="toc-defining-enso" class="nav-link" data-scroll-target="#defining-enso"><span class="header-section-number">10.7</span> Defining ENSO</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Gridded Data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">10.1</span> Introduction</h2>
<p>There are various sources of gridded data for climatic elements. Those considered here are from the European Organisation for the Exploitation of Meteorological Satellites, Satellite Application Facility on Climate Monitoring (EUMETSAT CM SAF), the Copernicus Climate Change Service (C3S) Climate Data Store and the International Research Institute for Climate and Society (IRI) Data Store.</p>
<p>All data are freely available. You need to register to access data from CM SAF, and also for the C3S Climate Data Store. The IRI Data Store does not require registration. The CM SAF data considered here are from stationary satellites and are available for all of Europe and Africa and possibly more, e.g.&nbsp;Middle East and Caribbean. Sunshine and radiation data are illustrated here. They are available daily (some hourly) on a grid of about 4km and are from 1983. Other elements, e.g.&nbsp;ground temperature are available hourly, from the early 1990s. They will later become available from the 1980s.</p>
<p>We consider the ERA5 reanalysis data from the C3S Climate Data Store. ERA5 is global, from 1979 (soon to be 1950) with a large number of elements available hourly on a grid of 0.25 by 0.25 degrees (about 30km). It is illustrated with precipitation (hourly) and with 2m temperature (used to derive daily Tmax and Tmin).</p>
<p>The IRI Data Store is a repository of climate data from a wide variety of sources. We illustrate the IRI Data Store by accessing daily precipitation estimates from CHIRPS and ENSO and sea-surface temperatures, that are commonly used for seasonal forecasting.</p>
<p>There are many possible uses and applications of these data. <mark>To be continued – with examples of what can be done and is being done.</mark></p>
</section>
<section id="importing-netcdf-files" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="importing-netcdf-files"><span class="header-section-number">10.2</span> Importing NetCDF files</h2>
<p>Show how to use the dialog first without changing options but still look at details to check what is being imported.</p>
<p>Then show the options for sub-areas, an individual station, or for multiple stations. Can use Rwanda station locations and CHIRPS data from IRI section.</p>
</section>
<section id="eumetsat-cm-saf" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="eumetsat-cm-saf"><span class="header-section-number">10.3</span> EUMETSAT CM SAF</h2>
<p>The CM SAF website is shown in Fig. 9.2a. You are invited to sign-in or register, though you are welcome to explore what is available without this. You need to register to download any data. You are then able to use these data freely. EUMETSAT would very much welcome any feedback on how the data have been used, particularly if, for example, you have compared your station data with their data. They may sometimes be prepared to assist you with using the data. You can contact EUMETSAT through their User Help Desk <a href="https://www.cmsaf.eu/EN/Service/UHD/UHD_node.html"><u>https://www.cmsaf.eu/EN/Service/UHD/UHD_node.html</u></a>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 97%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.2a</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.2a.png" style="width:6.26806in;height:2.93819in"></td>
</tr>
</tbody>
</table>
<p>Choose Surface Radiation products from the Climate Data Records menu in Fig. 9.2a. Choose daily sunshine duration, SDU, Fig. 9.2b.</p>
<p>From Fig. 9.2c we see the data are available from 1 January 1983 to the end of December 2017 (when this guide was written). There are other products from EUMETSAT CM SAF if more recent data are required, but they have not been through the homogenisation and quality control checks.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig 9.2b</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.2c</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.2b.png" style="width:3.13347in;height:2.43495in"></td>
<td style="text-align: left;"><img src="figures/Fig9.2c.png" style="width:2.91179in;height:2.72179in"></td>
</tr>
</tbody>
</table>
<p>Also indicated in Fig. 9.2c is that there is documentation on each product. Consider downloading these guides if you decide to use the data as they are very detailed and informative.</p>
<p>On the same screen as Fig. 9.2c you see an <strong><em>Add to Order Cart</em></strong> invitation. Ignore this for now, unless you want a huge file, with data from about half the globe.</p>
<p>Instead, scroll further down and click on the button that says <strong><em>Change Projection / spatial resolution / domain</em></strong>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.2d</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.2e</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.2d.png" style="width:2.19384in;height:2.02141in"></td>
<td style="text-align: left;"><img src="figures/Fig9.2e.png" style="width:3.94052in;height:1.55028in"></td>
</tr>
</tbody>
</table>
<p>If you are following this as an exercise, then change the coordinates in Fig. 9.2e.</p>
<p>Click, in Fig. 9.2e to proceed to the time range selection.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.2f</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.2g</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.2f.png" style="width:3.12627in;height:2.61119in"></td>
<td style="text-align: left;"><img src="figures/Fig9.2g.png" style="width:2.99713in;height:1.37602in"></td>
</tr>
</tbody>
</table>
<p>In the following screen, scroll down to confirm that the sub-domain, part of Rwanda, has been included, Fig. 9.2f. Then press Add to Order Cart, Fig. 9.2g.</p>
<p>You return to the screen in Fig. 9.2h. It is disconcerting that in Fig. 9.2h it appears you are about to order a file of over 200 gigabytes, but it is the size ignoring the sub-domain[^46]. Keep your nerve and place the order, Fig. 9.2h.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 97%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig.9.2h</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.2h.png" style="width:6.15232in;height:2.70945in"></td>
</tr>
</tbody>
</table>
<p>You receive a confirmatory e-mail that the order has been placed on the EUMETSAT server. Shortly afterwards there is confirmation that the data have been extracted and are waiting to be downloaded, Fig. 9.2i</p>
<table class="caption-top table">
<colgroup>
<col style="width: 97%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.2i</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.2i.png" style="width:6.10193in;height:2.96714in"></td>
</tr>
</tbody>
</table>
<p>Follow the instructions in your equivalent of the message in Fig. 9.2i to download the file. It is now, for the first time that you are made aware of the file size, 341 Mbytes for this example.</p>
<p>This downloads a single tar file, containing 12 thousand individual NetCDF files, with one file for each day.</p>
<p>This is continued, in Section 9.5, through the CM SAF toolbox and in Section <mark>xxx</mark> using R-Instat.</p>
</section>
<section id="c3s-climate-data-store" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="c3s-climate-data-store"><span class="header-section-number">10.4</span> C3S Climate Data Store</h2>
<p>If you are not online, then the first part of this section is again for reading only.</p>
<p>The website is <a href="https://cds.climate.copernicus.eu/" class="uri">https://cds.climate.copernicus.eu/</a>. This takes you to the screen partly shown in Fig. 9.3a. You are invited to login or register your account. So, do this.</p>
<p>Once logged in you return to the screen in Fig. 9.3a.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 97%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.3a</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.3a.png" style="width:6.12478in;height:2.76178in"></td>
</tr>
</tbody>
</table>
<p>Then click on Datasets in Fig. 9.3a to give the screen starting in Fig. 9.3b. There are many different datasets available. In the search bar type “ERA5 hourly” and from the results select, “ERA5 hourly data on single levels”.</p>
<p>Click on this dataset to get further information, see Fig. 9.3c.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 48%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.3b</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.3c</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.3b.png" style="width:3.02657in;height:1.58102in"></td>
<td style="text-align: left;"><img src="figures/Fig9.3c.png" style="width:3.04488in;height:2.00404in"></td>
</tr>
</tbody>
</table>
<p>The data are currently from 1979 (soon to be from 1950). They are available for many elements including precipitation, temperature, evaporation, radiation and wind speed and direction.</p>
<p>They are hourly data and at a 0.25 by 0.25-degree (about 25km) resolution.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 48%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.3d</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.3e</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.3d.png" style="width:3.12868in;height:2.06121in"></td>
<td style="text-align: left;"><img src="figures/Fig9.3e.png" style="width:2.86626in;height:2.20566in"></td>
</tr>
</tbody>
</table>
<p>On your first visit to the site, continue, and click on <strong><em>Download data</em></strong> in Fig. 9.3c. You then choose one or more elements, Fig. 9.3d and decide on the years, months, days and hours to include. Finally, select the sub-region to extract in the Geographical area section, Fig. 9.3f. Once the items in Fig. 9.3d, Fig. 9.3e and Fig. 9.3f are complete you can click <strong><em>Submit Form</em></strong> to start the request.</p>
<p>The running may take minutes (sometimes many) to complete. It also sometimes fails. You can view the current status of your requests by clicking <strong><em>Your requests</em></strong> from the menu bar shown in Fig. 9.3a. Occasionally there is a single error 500, in which case just run again. The other common error is that you have asked for too much data. If you are requesting a complete time series i.e.&nbsp;for all hours, days, and months, then the current limit appears to be approximately 5 years. This limit seems to be the same, irrespective of the area. Hence, for 30 years, make 6 separate requests, changing the years for each run. You do not need to wait for a request to complete before starting another one. Go to <strong><em>Your requests</em></strong> to see the status of each and download the data once complete.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.3f Generate a toolbox request</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.3g Names for each element</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.3f.png" style="width:3.01201in;height:2.82714in"></td>
<td style="text-align: left;"><img src="figures/Fig9.3g.png" style="width:3.09386in;height:1.70554in"></td>
</tr>
</tbody>
</table>
<p>An alternative way to request data is through the Toolbox, shown in the menu bar of the homepage in Fig. 9.3a. Previously, it was not possible to select a sub-region through the interface described above, hence it was necessary to construct a Python script to run the Toolbox in order to do this. However, now that sub-region extraction is possible in the interface, we suggest it is sufficient to use the interface if your main interest is to download data for use in another software e.g.&nbsp;R or R-Instat.</p>
<p>An example Toolbox script to download hourly 2-metre temperature data for sub-region covering in Rwanda for 5 years in shown Fig. 9.3i. The Toolbox also includes functionality for processing, analysing and displaying data, however this is not covered here as we will demonstrate importing ERA5 data into R-Instat.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><strong><em>Fig. 9.3h Sample toolbox code</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>import cdstoolbox as ct</strong></p>
<p><strong>@ct.application(title='Retrieve Data')</strong></p>
<p><strong>@ct.output.dataarray()</strong></p>
<p><strong>def retrieve_sample_data():</strong></p>
<p><strong>"""</strong></p>
<p><strong>Application main steps:</strong></p>
<p><strong>- retrieve 2m temperature of ERA5 from CDS Catalogue</strong></p>
<p><strong>- specify the grid - year(s) - month(s) - day(s) - hour(s)</strong></p>
<p><strong>- area is optional give N/W/S/E corners</strong></p>
<p><strong>- recommended for local analysis</strong></p>
<p><strong>- ask for netcdf format</strong></p>
<p><strong>"""</strong></p>
<p><strong>data = ct.catalogue.retrieve(</strong></p>
<p><strong>'reanalysis-era5-single-levels',</strong></p>
<p><strong>{</strong></p>
<p><strong>'variable': '2m_temperature',</strong></p>
<p><strong>'grid': ['0.25', '0.25'],</strong></p>
<p><strong>'product_type': 'reanalysis',</strong></p>
<p><strong>'year': [</strong></p>
<p><strong>'1981',‘1982’,‘1983’,‘1984’,‘1985’</strong></p>
<p><strong>],</strong></p>
<p><strong>'month': [</strong></p>
<p><strong>'01', '02', '03', '04', '05', '06','07', '08', '09', '10', '11', '12',</strong></p>
<p><strong>],</strong></p>
<p><strong>'day': [</strong></p>
<p><strong>'01', '02', '03', '04', '05', '06','07', '08', '09', '10', '11', '12',</strong></p>
<p><strong>'13', '14', '15', '16', '17', '18','19', '20', '21', '22', '23', '24',</strong></p>
<p><strong>'25', '26', '27', '28', '29', '30','31'</strong></p>
<p><strong>],</strong></p>
<p><strong>'time': [</strong></p>
<p><strong>'00:00','01:00','02:00','03:00','04:00','05:00',</strong></p>
<p><strong>'06:00','07:00','08:00','09:00','10:00','11:00',</strong></p>
<p><strong>'12:00','13:00','14:00','15:00','16:00','17:00',</strong></p>
<p><strong>'18:00','19:00','20:00','21:00','22:00','23:00'</strong></p>
<p><strong>],</strong></p>
<p><strong>'area': ['-1.5/30/-2.0/30.54'],</strong></p>
<p><strong>'format' : ['netcdf']</strong></p>
<p><strong>})</strong></p>
<p><strong>return data</strong></p></td>
</tr>
</tbody>
</table>
<p>The second stage is to read the resulting data into R-Instat. For those who were not online, the six files have also been renamed and copied into the R-Instat library.</p>
<p><strong><em>Go into R-Instat</em></strong> and use <strong><em>File &gt; Open and Tidy NetCDF File</em></strong> Fig. 9.3i.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.3i Loading the data for 1981-5</em></strong></th>
<th style="text-align: right;"><strong><em>Fig. 9.3j Six files in R-Instat</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.3i.png" style="width:2.93324in;height:2.8244in"></td>
<td style="text-align: right;"><img src="figures/Fig9.3j.png" style="width:3.16845in;height:2.59489in"></td>
</tr>
</tbody>
</table>
<p>In Fig. 9.3j, if you downloaded your own data, then choose <strong><em>Browse</em></strong>, otherwise choose <strong><em>From Library</em></strong> and <strong><em>use the file called cds.Rwanda_1981_5.nc</em></strong>.</p>
<p>Then recall the last dialogue and include the other five files, up to cds.Rwanda_2005_10. The resulting data are shown in Fig. 9.3k. There are about 394,416 rows of data in each file (i.e.&nbsp;roughly 9 * 24 * 365 * 5)</p>
<p>The next step is to append the files to give the 30-year record. Use <strong><em>Climatic &gt;Tidy and Examine &gt; Append</em></strong>, Fig. 9.3l. In Fig. 9.3k, include all 6 data frame, then the ID column isn’t needed and the resulting data frame is named better than Append1.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.3k Appending the 6 data frames</em></strong></th>
<th style="text-align: right;"><strong><em>Fig. 9.3l Temperatures into centigrade</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.3k.png" style="width:3.14829in;height:3.01165in"></td>
<td style="text-align: right;"><img src="figures/Fig9.3l.png" style="width:2.91954in;height:2.77761in"></td>
</tr>
</tbody>
</table>
<p>The data column in Fig. 9.3k, called tas, is in degrees Kelvin. Use <strong><em>Climatic &gt; Prepare &gt; Transform</em></strong> to change them into centigrade for comparison with the station data, Fig. 9.3m.</p>
<p>ECMWF provides the time variable always in GMT (Greenwich Mean Time). Rwanda is 2 hours ahead, so either, or both, the time variables in Fig. 9.3k need to be moved forward by 2 hours. To make this change the data should first be in “station” order. Hence first <strong><em>Right-Click</em></strong> and choose <strong><em>Sort</em></strong> (or use Prepare &gt; Data Frame &gt; Sort) to produce the dialogue in Fig. 9.3m.</p>
<p>Now use <strong><em>Prepare &gt; Column: Calculate &gt; Calculations</em></strong> as shown in Fig. 9.3n. In the calculator the <strong><em>Transform</em></strong> keyboard includes the <strong><em>lead</em></strong> function. The function, from the dplyr package is:</p>
<p><strong><em>dplyr::lead(time_full,2)</em></strong>, to move to Rwanda time. Pressing the <strong><em>Try</em></strong> button in Fig. 9.3n shows the first value is now 2am GMT[^47].</p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.3m</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.3n</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.3m.png" style="width:3.14829in;height:3.01165in"></td>
<td style="text-align: left;"><img src="figures/Fig9.3n.png" style="width:2.91954in;height:2.77761in"></td>
</tr>
</tbody>
</table>
<p>Now use <strong><em>Climatic &gt; Dates &gt; Make Date</em></strong> to make a new Date column from the Rwanda hourly column, Fig. 9.3o.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.3o</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.3p</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.3o.png" style="width:2.93324in;height:2.8244in"></td>
<td style="text-align: left;"><img src="figures/Fig9.3p.png" style="width:3.16845in;height:2.59489in"></td>
</tr>
</tbody>
</table>
<p>Finally generate Tmax and Tmin, on a daily basis, from the hourly values, ready to use, or to compare with station data. First <strong><em>right-click</em></strong> and make the <strong><em>lon and lat columns into factors</em></strong>. The hourly data are now roughly as in Fig. 9.3p</p>
<p>Complete the <strong><em>Prepare &gt; Column: Reshape &gt; Column Summaries</em></strong> dialogue as shown in Fig. 9.3q. As these are temperatures the daily maximum and minimum are calculated. The resulting worksheet, Fig. 9.3r, has a more reasonable 100,000 rows of data at the 9 gridpoints.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.3q</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.3r Resulting daily data</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.3q.png" style="width:3.14829in;height:3.01165in"></td>
<td style="text-align: left;"><img src="figures/Fig9.3r.png" style="width:2.91954in;height:2.77761in"></td>
</tr>
</tbody>
</table>
</section>
<section id="the-iri-data-store" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="the-iri-data-store"><span class="header-section-number">10.5</span> The IRI Data Store</h2>
<p>A third source of gridded data considered here is the IRI Data Library. IRI is the International Research Institute for Climate and Society based in Colombia University, USA. The website for their data library is <a href="http://iridl.ldeo.columbia.edu/"><u>http://iridl.ldeo.columbia.edu/</u></a> , Fig. 9.4a. The IRI Data Store is a large repository of climate data from a wide variety of sources. In many cases, the IRI Data Store is not the only, or primary, source of the data, however the IRI Data Store provides a simple consistent way of freely downloading from a large set of sources, and crucially allows for selecting sub-regions.</p>
<p>As well as downloading from the website, R-Instat includes a dialog to directly download and import some of the common data from the IRI Data Store. We demonstrate both methods here, using the R-Instat dialog to download CHIRPS daily rainfall estimates and the IRI Data Store website to download information on ENSO and sea surface temperatures.</p>
<section id="downloading-directly-from-r-instat" class="level3" data-number="10.5.1">
<h3 data-number="10.5.1" class="anchored" data-anchor-id="downloading-directly-from-r-instat"><span class="header-section-number">10.5.1</span> Downloading directly from R-Instat</h3>
<p>Climate Hazards Group InfraRed Precipitation with Station data (CHIRPS), produced by Climate Hazards Center UC Santa Barbara, USA, is a near-global gridded rainfall data set, available from 1981 to near-present with a spatial resolution of 0.05°. It is constructed by combining satellite imagery and in-situ station data, and is available on a daily, dekad and monthly basis. It’s website is here <a href="https://www.chc.ucsb.edu/data/chirps"><u>https://www.chc.ucsb.edu/data/chirps</u></a> but the data is more easily available to download and subset from the IRI Data Store. It is an example of one of the datasets available to download directly from R-Instat.</p>
<p>In R-Instat go to <strong><em>Climatic &gt; File &gt; Import from IRI Data Library</em></strong>, fig xxx. First select “UCSB CHIRPS” as the <strong><em>Source</em></strong>. We will download the daily data with the highest resolution available, hence choose “Daily Precipitation 0.05 degree” as the <strong><em>Data</em></strong>, fig xxx. Source shows a limited set of data sources available in the IRI Data Store which we think will be most commonly used by R-Instat users. If there is a dataset from the IRI Data Store that you commonly use and think we should add, please let us know and we can consider adding it to the dialog.</p>
<p>The next two sections of the dialog allow for choosing a subset of time or location. By default, “Entire Range” is selected for the data range. For CHIRPS, this means 1981 to near-present. We will use this option, but if you want a shorter time period choose “Custom Range” and select the “From” and “To” dates. The Location Range allows you to choose an area defined by longitude and latitude limits, or a single point, which will extract the nearest grid point to the location you provide. Let’s first choose a single point for Kigali, Rwanda at longitude 30.1 and latitude -1.95, fig xxx.</p>
<p>The dialog will connect to the IRI Data Library and download the requested data to your machine as a NetCDF file (.nc), a common format for gridded data (CM SAF and C3S Climate Data Store data are also provided in this format). Click <strong><em>Browse</em></strong> to choose where the download data will be saved to or accept the default of your Documents folder. Choose an appropriate name for the new data frame. Now, click <strong><em>Ok</em></strong> to download and import the data into R-Instat. It may take some time for the request to be processed (up to 30 minutes), particularly for requests that are for a long time period since data are usually stored in separate files for each time point. However, this does not mean the download will be a large file and the time can vary depending on how busy the IRI Data Library servers are. While waiting, you will see the R-Instat waiting dialog and the download progress bar. Do not worry if the progress bar does not move forward, this just means the request is still being processed. Once the request has been processed, the download will usually be small and take very little time. For example, this request should result in a download file of size ~0.1MB.</p>
<p>After finishing you will see the data imported into R-Instat, fig xxx. The NetCDF file has been downloaded to the location chosen on the dialog (Documents by default) and the file has been imported into a data frame in R-Instat. The data frame has five columns. X and Y are the location and this should be constant since we requested a single point. Notice that the value in Y is not exactly what we request. It is -1.97 and we request -1.95. This is because the closed grid point in the CHIRPS data grid to the provided location is selected. .T is time as a number and T_date is a more useful column that is created by R-Instat when importing as a Date column. prcp is precipitation. We can confirm this by looking at the column metadata: <strong><em>View &gt; Column Metadata</em></strong>. Scroll to the end to see the “standard_name” and “units” columns which confirm what each column represents and its units, fig xxx. Click <strong><em>View &gt; Column Metadata</em></strong> again to close the metadata. We can see that each row in the data represents a single day, starting on 1981-01-01. Use <strong><em>Describe &gt; One Variable &gt; Summaries</em></strong>, and select all columns to see a summary of the data. The output is shown in fig xxx. We see that X and Y are constant, as expected. .T is numeric and not that useful, but T_date show the data ranges from 1981-01-01 to 2020-08-31 (as of October 2020, usually 1 or 2 months behind the current date). prcp shows a sensible set of summaries for daily rainfall values. This is useful to do to confirm that the request is as you expected. For example, if X and Y are not constant but you wanted just a single point, then you may not have done the request correctly.</p>
<p>Notice that the data file is also stored on your machine in the folder you chose. For example, in Documents my file is called ucsb_chirps7f14482329.nc. If you need to import this data again, you can now use the file directly, without requesting it again from the IRI Data Store. See section xxx on how to import NetCDF files.</p>
<p>This data is useful for comparison with a single station in Kigali. We often have data from multiple stations and would wish to extract gridded data at each of the station locations. One way to do this would be to make separate requests for each station location using the Import from IRI Data Library multiple times. However, this becomes time consuming for many stations, particularly if the processing time is slow. Another option is to do a single request and download data for an area that covers all the station locations and then afterwards extract the data for the required locations.</p>
<p>So let’s to this by download the same data for an area that covers Rwanda instead of a single point. This will be a larger download file ~280MB but should not take much longer to process. If you have an internet connection able to download ~300MB of data then try the next steps below. If not, then this is just for reading.</p>
<p>Go back to the <strong><em>Import from IRI Data Library</em></strong> dialog. The <strong><em>Source</em></strong>, <strong><em>Data</em></strong> and <strong><em>Date Range</em></strong> options remain the same. Change the <strong><em>Location Range</em></strong> option from “Point” to “Area” and enter the values: longitude: min 28.5, max 30.5, latitude: min -2.5, max -1.4. This area covers the four stations in Rwanda found in the R-Instat Library. Choose the location to save the download or use the same location. Now, the data request is for approximately a 2 degrees by 1 degree area, which will give approximately (2 / 0.05) x (1 / 0.05) = 40 x 20 = 800 grid points, since the resolution is 0.05 degrees. We do not want to directly import all 800 grid points into R-Instat as this would be equivalent to 800 station records for 40 years. Instead, we want to download the data and then extract only a few grid points of interest afterwards. So we will check the option for “Don’t import data after downloading”. This removes the new data frame name as it will not import into R-Instat but will just download to your machine. Now click <strong><em>Ok</em></strong> and it may take a similar amount of time to complete.</p>
<p>After finishing you will not see any change in R-Instat but the file will be downloaded to the chosen folder. We can now use the dialog at <strong><em>Climatic &gt; File &gt; Import &amp; Tidy NetCDF</em></strong> to import a subset of the grid points based on station locations. This is shown in section xxx.</p>
</section>
<section id="download-from-the-iri-data-store" class="level3" data-number="10.5.2">
<h3 data-number="10.5.2" class="anchored" data-anchor-id="download-from-the-iri-data-store"><span class="header-section-number">10.5.2</span> Download from the IRI Data Store</h3>
<p>As examples, information on ENSO and sea surface temperatures are accessed. The maproom also contains instructional information, so typing ENSO into the search, Fig. 9.4a, provides useful information, including the areas of the Pacific ocean associated with the NINO situations, Fig. 9.4b. Fig. 9.4b is accessed directly from <a href="https://iridl.ldeo.columbia.edu/maproom/ENSO/Diagnostics.html"><u>https://iridl.ldeo.columbia.edu/maproom/ENSO/Diagnostics.html</u></a></p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig.9.4a IRI Data Library</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.4b NINO3.4</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.4a.png" style="width:3.86687in;height:2.70544in"></td>
<td style="text-align: left;"><img src="figures/Fig9.4b.png" style="width:2.13099in;height:2.70683in"></td>
</tr>
</tbody>
</table>
<p>In Fig. 9.4a click on Data by Category, then on Climate Indices, Fig. 9.4c and choose Indices nino EXTENDED, Fig. 9.4d.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th><strong><em>Fig. 9.4c</em></strong> **</th>
<th style="text-align: left;"><em>Fig. 9.4d</em>**</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><img src="figures/Fig9.4c.png" style="width:2.69988in;height:2.47055in"></td>
<td style="text-align: left;"><img src="figures/Fig9.4d.png" style="width:3.42604in;height:2.22844in"></td>
</tr>
</tbody>
</table>
<p>Choose <strong><em>nino34</em></strong>, in Fig. 9.4e and then go straight to <strong><em>data files</em></strong>. The next screen shows a variety of output formats, including NetCDF, which you choose.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.4e</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.4f</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.4e.png" style="width:3.07506in;height:3.07958in"></td>
<td style="text-align: left;"><img src="figures/Fig9.4f.png" style="width:2.8994in;height:3.59878in"></td>
</tr>
</tbody>
</table>
<p>Now, in R-Instat, use File &gt; Open and Tidy NetCDF File. If you followed the screens above, then browse for the file that was downloaded. Otherwise there is a copy in the R-Instat library to March 2019, Fig. 9.4g.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 48%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.4g</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.4h</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.4g.png" style="width:2.84199in;height:2.86736in"></td>
<td style="text-align: left;"><img src="figures/Fig9.4h.png" style="width:2.64771in;height:3.06124in"></td>
</tr>
</tbody>
</table>
<p>The data are now imported into R-Instat, Fig. 9.4h. The time variable has not been recognised as a date. You may wish to click on the I (for information – the metadata) and this will confirm that the column, called T, is months since January 1960. If the fact that some values appear the same in this column, then change the number of significant figures in that column, from 3 to 5.</p>
<p>The first value of T, in Fig. 9.4h is -1248. Dividing by 12 gives 104 years, so the data start in January 1856!</p>
<p>Use Climatic &gt; Dates &gt; Generate Dates, Fig. 9.4i. In Fig. 9.4i, change the starting date to January 1856, the end date to March 2019 (if using the library dataset), and the step to 1 Month. The resulting date column is shown in Fig. 9.4j.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 48%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.4i</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.4j</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.4i.png" style="width:2.84199in;height:2.86736in"></td>
<td style="text-align: left;"><img src="figures/Fig9.4j.png" style="width:2.64771in;height:3.06124in"></td>
</tr>
</tbody>
</table>
<p>Countries have their own definition of when the NINO3.4 implies a year, or season is El Niño, or La Niña, see <a href="https://en.wikipedia.org/wiki/El_Ni%C3%B1o"><u>https://en.wikipedia.org/wiki/El_Ni%C3%B1o</u></a>, some use the NINO3.4 value and others use NINo3, or even NINO1 and 2. The site <a href="http://www.bom.gov.au/climate/enso/enlist/index.shtml"><u>http://www.bom.gov.au/climate/enso/enlist/index.shtml</u></a> gives a detailed description of El Niño events since 1900, Fig. 9.4k, with a companion page for La Niña.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 48%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.4k</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.4l</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.4k.png" style="width:3.47098in;height:2.18081in"></td>
<td style="text-align: left;"><img src="figures/Fig9.4l.png" style="width:2.5918in;height:1.72133in"></td>
</tr>
</tbody>
</table>
<p>The SSTs themselves are often used for seasonal forecasting. This is illustrated with the SSTs for the Nino3.4 region.</p>
<p><strong><em>Return to the main page</em></strong>, Fig. 9.4a, then choose <strong><em>Data by Category</em></strong> again, but this time, in Fig. 9.4c, choose <strong><em>Air-Sea Interface</em></strong>. In the resulting screen, choose the <strong><em>NOAA NCDC ERSST version5</em></strong>, Fig. 9.4l.</p>
<p>In the resulting screen, Fig. 9.4m, choose <strong><em>anomalies</em></strong> and then <strong><em>Data Selection</em></strong>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 48%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.4m</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.4n</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.4m.png" style="width:2.99111in;height:2.3437in"></td>
<td style="text-align: left;"><img src="figures/Fig9.4n.png" style="width:3.06222in;height:2.59055in"></td>
</tr>
</tbody>
</table>
<p>Set the <strong><em>time, attitude and longitude</em></strong> as shown in Fig. 9.4n and then <strong><em>Restrict Ranges</em></strong>. The part at the top of Fig. 9.4n should change accordingly and you now press <strong><em>Stop Selecting</em></strong>.</p>
<p>Fig. 9.4m now has the three ranges added, in blue, Fig. 9.4o. Click on Data Files to give the same as Fig. 9.4f, earlier. Choose the NetCDF option again to download the file.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.4o</em></strong></th>
<th style="text-align: left;"><strong><em>Fig. 9.4p</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.4o.png" style="width:2.78099in;height:1.84508in"></td>
<td style="text-align: left;"><img src="figures/Fig9.4p.png" style="width:3.29054in;height:2.7998in"></td>
</tr>
</tbody>
</table>
<p>Use the File &gt; Input and Tidy NetCDF File as in Fig. 9.4g. Then use the Climatic &gt; Dates &gt; Generate Dates dialogue as shown in Fig. 9.4p. In Fig. 9.4p, remember to change to the new data frame. Then set the starting date to January 1921 and there are now 130 values (26 E-W, by 5 N-S) at each time point.</p>
<p>In Fig. 9.4p, if all is correct, the generated sequence should match the length of the data frame. Once accepted, the resulting data frame is shown in Fig. 9.4q. Here each pixel is a 2 degree square, so the first row is the temperature anomaly round 120°W and 4°S for January 1921.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 97%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong><em>Fig. 9.4q</em></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><img src="figures/Fig9.4q.png" style="width:2.99399in;height:3.17561in"></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="using-the-cm-saf-toolbox-for-netcdf-files" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="using-the-cm-saf-toolbox-for-netcdf-files"><span class="header-section-number">10.6</span> Using the CM SAF toolbox for NetCDF files</h2>
<p>The CM SAF toolbox is an R software package designed to process the NetCDF files downloaded from EUMETSAT, Section 9.3. It is used on the downloaded files from EUMETSAT (or from other organisations who have NetCDF files). This may be all you need, if your interest is in some products from the EUMETSAT data. Or it may be before using R-Instat if your interest is in comparing station and satellite data.</p>
</section>
<section id="defining-enso" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="defining-enso"><span class="header-section-number">10.7</span> Defining ENSO</h2>
<p>See <a href="https://www.ncdc.noaa.gov/teleconnections/enso/indicators/sst/"><u>https://www.ncdc.noaa.gov/teleconnections/enso/indicators/sst/</u></a></p>
<p><mark>Warm and cold phases are defined as a minimum of five consecutive 3-month running mean of SST anomalies (<a href="http://origin.cpc.ncep.noaa.gov/products/analysis_monitoring/ensostuff/ONI_v5.php"><u>ERSST.v5</u></a>) in the Niño 3.4 region surpassing a threshold of +/- 0.5°C</mark></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter_8_Efficient_use_of_RInstat_and_R.html" class="pagination-link" aria-label="Efficient use of R-Instat and R">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Efficient use of R-Instat and R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter_10_Comparing_Data_from_Different_Sources.html" class="pagination-link" aria-label="Comparing Data from Different Sources">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Comparing Data from Different Sources</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>